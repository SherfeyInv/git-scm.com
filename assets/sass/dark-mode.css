@mixin mode($mode: light, $theme: "") {
    // Palette
    $orange:                  #f14e32;
    $blue:                    #009099;
    $font-color:              #4e443c;
    $aside-font-color:        lighten($font-color, 20%);
    $light-font-color:        #9a9994;
    $link-color:              #0388a6;
    $fixed-width-font-color:  #4e443c;
    $button-bg-color:         #dfddd554;
    $button-bg-hover-color:   #fafafae5;
    $base-border-color:       #d8d7cf;
    $callout-color:           #e9e8e0;
    $highlight-bg-color:      #eee0b5;
    $black-3:                 #333333;
    $main-bg:                 #fcfcfa;
    $bg-color:                #f0efe7 url($baseurl + "images/bg/body.jpg");
    $sidebar-bg-color:        #efefe7;

    @if $mode == dark {
        $orange:                  #d7834f;
        $blue:                    #007a7e;
        $font-color:              #b3b1b1;
        $aside-font-color:        darken($font-color, 10%);
        $light-font-color:        #bdbbb0;
        $link-color:              #d7834f;
        $fixed-width-font-color:  #afa7a0;
        $button-bg-hover-color:   #dfddd599;
        $base-border-color:       #b3b2a7;
        $callout-color:           #555555;
        $highlight-bg-color:      #47412d;
        $black-3:                 #cccccc;
        $main-bg:                 #333333;
        $bg-color:                #2a2a2aff;
        $sidebar-bg-color:        #3d3d3a;

        :root#{$theme} {
            div#masthead {
                background: transparent;
            }

            div#masthead::before {
                content: "";
                width: 100%;
                height: 295px;
                @include background-image-2x($baseurl + "images/bg/isometric-grid", 35px, 21px, top right, repeat);
                position: absolute;
                filter: brightness(.4) contrast(1.6);
                z-index: -1;
            }

            img {
                filter: brightness(.6) contrast(1.2);
            }

            a.subtle-button {
                background-image: linear-gradient(#555555, #777777);
                border-top: solid 1px #333333;
                border-right: solid 1px #333333;
                border-bottom: solid 1px #333333;
                border-left: solid 1px #333333;
                @include box-shadow(none);
            }

            #documentation #main div.verseblock pre.content {
                color: var(--light-font-color);
                background-color: #5e5951;
            }
        }
    }

    :root#{$theme} {
        --orange:                       #{$orange};
        --orange-darker-5:              #{darken($orange, 5%)};
        --blue:                         #{$blue};
        --font-color:                   #{$font-color};
        --aside-font-color:             #{$aside-font-color};
        --light-font-color:             #{$light-font-color};
        --light-font-color-darker-10:   #{darken($light-font-color, 10%)};
        --light-font-color-darker-25:   #{darken($light-font-color, 25%)};
        --light-font-color-darker-35:   #{darken($light-font-color, 35%)};
        --light-font-color-darker-55:   #{darken($light-font-color, 55%)};
        --light-font-color-lighter-20:  #{lighten($light-font-color, 20%)};
        --link-color:                   #{$link-color};
        --link-hover-color:             #{lighten($link-color, 10%)};
        --fixed-width-font-color:       #{$fixed-width-font-color};
        --button-bg-color:              #{$button-bg-color};
        --button-bg-hover-color:        #{$button-bg-hover-color};
        --base-border-color:            #{$base-border-color};
        --base-border-color-darker-8:   #{darken($base-border-color, 8%)};
        --base-border-color-lighter-10: #{lighten($base-border-color, 10%)};
        --callout-color:                #{$callout-color};
        --highlight-bg-color:           #{$highlight-bg-color};

        --black-3:                      #{$black-3};
        --main-bg:                      #{$main-bg};
        --sidebar-bg-color:             #{$sidebar-bg-color};
        --bg-color:                     #{$bg-color};
    }
}

@include mode
@include mode($mode: dark, $theme: '[data-theme="dark"]')

@media screen and (prefers-color-scheme: dark) {
    @include mode($mode: dark, $theme: ':not([data-theme="light"])')
    @include mode($mode: light)
}
