---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - api-tree-walking Documentation
docname: api-tree-walking
version: 2.0.5
aliases:
- "/docs/api-tree-walking/2.0.5/index.html"
- "/docs/api-tree-walking/2.1.4/index.html"
- "/docs/api-tree-walking/2.2.3/index.html"
- "/docs/api-tree-walking/2.3.10/index.html"
- "/docs/api-tree-walking/2.4.12/index.html"
- "/docs/api-tree-walking/2.5.6/index.html"
- "/docs/api-tree-walking/2.6.7/index.html"
- "/docs/api-tree-walking/2.7.6/index.html"
- "/docs/api-tree-walking/2.8.6/index.html"
- "/docs/api-tree-walking/2.9.5/index.html"
- "/docs/api-tree-walking/2.10.5/index.html"
- "/docs/api-tree-walking/2.11.4/index.html"
- "/docs/api-tree-walking/2.12.5/index.html"
- "/docs/api-tree-walking/2.13.7/index.html"
- "/docs/api-tree-walking/2.14.6/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The tree walking API is used to traverse and inspect trees.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_structures"><a class="anchor" href="#_data_structures"></a>Data Structures</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodestructcodecodenameentrycodespan"><a id="Documentation/technical/api-tree-walking.txt-structnameentry" class="anchor" href="#Documentation/technical/api-tree-walking.txt-structnameentry"></a><span class='synopsis'><code>struct</code> <code>name_entry</code></span> </dt>
<dd>
<p>An entry in a tree. Each entry has a sha1 identifier, pathname, and
mode.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodestructcodecodetreedesccodespan"><a id="Documentation/technical/api-tree-walking.txt-structtreedesc" class="anchor" href="#Documentation/technical/api-tree-walking.txt-structtreedesc"></a><span class='synopsis'><code>struct</code> <code>tree_desc</code></span> </dt>
<dd>
<p>A semi-opaque data structure used to maintain the current state of the
walk.</p>
<div class="ulist">
<ul>
<li>
<p><span class='synopsis'><code>buffer</code></span> is a pointer into the memory representation of the tree. It always
points at the current entry being visited.</p>
</li>
<li>
<p><span class='synopsis'><code>size</code></span> counts the number of bytes left in the <span class='synopsis'><code>buffer</code></span>.</p>
</li>
<li>
<p><span class='synopsis'><code>entry</code></span> points to the current entry being visited.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodestructcodecodetraverseinfocodespan"><a id="Documentation/technical/api-tree-walking.txt-structtraverseinfo" class="anchor" href="#Documentation/technical/api-tree-walking.txt-structtraverseinfo"></a><span class='synopsis'><code>struct</code> <code>traverse_info</code></span> </dt>
<dd>
<p>A structure used to maintain the state of a traversal.</p>
<div class="ulist">
<ul>
<li>
<p><span class='synopsis'><code>prev</code></span> points to the traverse_info which was used to descend into the
current tree. If this is the top-level tree <span class='synopsis'><code>prev</code></span> will point to
a dummy traverse_info.</p>
</li>
<li>
<p><span class='synopsis'><code>name</code></span> is the entry for the current tree (if the tree is a subtree).</p>
</li>
<li>
<p><span class='synopsis'><code>pathlen</code></span> is the length of the full path for the current tree.</p>
</li>
<li>
<p><span class='synopsis'><code>conflicts</code></span> can be used by callbacks to maintain directory-file conflicts.</p>
</li>
<li>
<p><span class='synopsis'><code>fn</code></span> is a callback called for each entry in the tree. See Traversing for more
information.</p>
</li>
<li>
<p><span class='synopsis'><code>data</code></span> can be anything the <span class='synopsis'><code>fn</code></span> callback would want to use.</p>
</li>
<li>
<p><span class='synopsis'><code>show_all_errors</code></span> tells whether to stop at the first error or not.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_initializing"><a class="anchor" href="#_initializing"></a>Initializing</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodeinittreedesccodespan"><a id="Documentation/technical/api-tree-walking.txt-inittreedesc" class="anchor" href="#Documentation/technical/api-tree-walking.txt-inittreedesc"></a><span class='synopsis'><code>init_tree_desc</code></span> </dt>
<dd>
<p>Initialize a <span class='synopsis'><code>tree_desc</code></span> and decode its first entry. The buffer and
size parameters are assumed to be the same as the buffer and size
members of <span class='synopsis'><code>struct</code> <code>tree</code></span>.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodefilltreedescriptorcodespan"><a id="Documentation/technical/api-tree-walking.txt-filltreedescriptor" class="anchor" href="#Documentation/technical/api-tree-walking.txt-filltreedescriptor"></a><span class='synopsis'><code>fill_tree_descriptor</code></span> </dt>
<dd>
<p>Initialize a <span class='synopsis'><code>tree_desc</code></span> and decode its first entry given the sha1 of
a tree. Returns the <span class='synopsis'><code>buffer</code></span> member if the sha1 is a valid tree
identifier and NULL otherwise.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodesetuptraverseinfocodespan"><a id="Documentation/technical/api-tree-walking.txt-setuptraverseinfo" class="anchor" href="#Documentation/technical/api-tree-walking.txt-setuptraverseinfo"></a><span class='synopsis'><code>setup_traverse_info</code></span> </dt>
<dd>
<p>Initialize a <span class='synopsis'><code>traverse_info</code></span> given the pathname of the tree to start
traversing from. The <span class='synopsis'><code>base</code></span> argument is assumed to be the <span class='synopsis'><code>path</code></span>
member of the <span class='synopsis'><code>name_entry</code></span> being recursed into unless the tree is a
top-level tree in which case the empty string ("") is used.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_walking"><a class="anchor" href="#_walking"></a>Walking</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodetreeentrycodespan"><a id="Documentation/technical/api-tree-walking.txt-treeentry" class="anchor" href="#Documentation/technical/api-tree-walking.txt-treeentry"></a><span class='synopsis'><code>tree_entry</code></span> </dt>
<dd>
<p>Visit the next entry in a tree. Returns 1 when there are more entries
left to visit and 0 when all entries have been visited. This is
commonly used in the test of a while loop.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodetreeentrylencodespan"><a id="Documentation/technical/api-tree-walking.txt-treeentrylen" class="anchor" href="#Documentation/technical/api-tree-walking.txt-treeentrylen"></a><span class='synopsis'><code>tree_entry_len</code></span> </dt>
<dd>
<p>Calculate the length of a tree entry&#8217;s pathname. This utilizes the
memory structure of a tree entry to avoid the overhead of using a
generic strlen().</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodeupdatetreeentrycodespan"><a id="Documentation/technical/api-tree-walking.txt-updatetreeentry" class="anchor" href="#Documentation/technical/api-tree-walking.txt-updatetreeentry"></a><span class='synopsis'><code>update_tree_entry</code></span> </dt>
<dd>
<p>Walk to the next entry in a tree. This is commonly used in conjunction
with <span class='synopsis'><code>tree_entry_extract</code></span> to inspect the current entry.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodetreeentryextractcodespan"><a id="Documentation/technical/api-tree-walking.txt-treeentryextract" class="anchor" href="#Documentation/technical/api-tree-walking.txt-treeentryextract"></a><span class='synopsis'><code>tree_entry_extract</code></span> </dt>
<dd>
<p>Decode the entry currently being visited (the one pointed to by
<span class='synopsis'><code>tree_desc's</code></span> <span class='synopsis'><code>entry</code></span> member) and return the sha1 of the entry. The
<span class='synopsis'><code>pathp</code></span> and <span class='synopsis'><code>modep</code></span> arguments are set to the entry&#8217;s pathname and mode
respectively.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodegettreeentrycodespan"><a id="Documentation/technical/api-tree-walking.txt-gettreeentry" class="anchor" href="#Documentation/technical/api-tree-walking.txt-gettreeentry"></a><span class='synopsis'><code>get_tree_entry</code></span> </dt>
<dd>
<p>Find an entry in a tree given a pathname and the sha1 of a tree to
search. Returns 0 if the entry is found and -1 otherwise. The third
and fourth parameters are set to the entry&#8217;s sha1 and mode
respectively.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_traversing"><a class="anchor" href="#_traversing"></a>Traversing</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodetraversetreescodespan"><a id="Documentation/technical/api-tree-walking.txt-traversetrees" class="anchor" href="#Documentation/technical/api-tree-walking.txt-traversetrees"></a><span class='synopsis'><code>traverse_trees</code></span> </dt>
<dd>
<p>Traverse <span class='synopsis'><code>n</code></span> number of trees in parallel. The <span class='synopsis'><code>fn</code></span> callback member of
<span class='synopsis'><code>traverse_info</code></span> is called once for each tree entry.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodetraversecallbacktcodespan"><a id="Documentation/technical/api-tree-walking.txt-traversecallbackt" class="anchor" href="#Documentation/technical/api-tree-walking.txt-traversecallbackt"></a><span class='synopsis'><code>traverse_callback_t</code></span> </dt>
<dd>
<p>The arguments passed to the traverse callback are as follows:</p>
<div class="ulist">
<ul>
<li>
<p><span class='synopsis'><code>n</code></span> counts the number of trees being traversed.</p>
</li>
<li>
<p><span class='synopsis'><code>mask</code></span> has its nth bit set if something exists in the nth entry.</p>
</li>
<li>
<p><span class='synopsis'><code>dirmask</code></span> has its nth bit set if the nth tree&#8217;s entry is a directory.</p>
</li>
<li>
<p><span class='synopsis'><code>entry</code></span> is an array of size <span class='synopsis'><code>n</code></span> where the nth entry is from the nth tree.</p>
</li>
<li>
<p><span class='synopsis'><code>info</code></span> maintains the state of the traversal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Returning a negative value will terminate the traversal. Otherwise the
return value is treated as an update mask. If the nth bit is set the nth tree
will be updated and if the bit is not set the nth tree entry will be the
same in the next callback invocation.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodemaketraversepathcodespan"><a id="Documentation/technical/api-tree-walking.txt-maketraversepath" class="anchor" href="#Documentation/technical/api-tree-walking.txt-maketraversepath"></a><span class='synopsis'><code>make_traverse_path</code></span> </dt>
<dd>
<p>Generate the full pathname of a tree entry based from the root of the
traversal. For example, if the traversal has recursed into another
tree named "bar" the pathname of an entry "baz" in the "bar"
tree would be "bar/baz".</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-spanclasssynopsiscodetraversepathlencodespan"><a id="Documentation/technical/api-tree-walking.txt-traversepathlen" class="anchor" href="#Documentation/technical/api-tree-walking.txt-traversepathlen"></a><span class='synopsis'><code>traverse_path_len</code></span> </dt>
<dd>
<p>Calculate the length of a pathname returned by <span class='synopsis'><code>make_traverse_path</code></span>.
This utilizes the memory structure of a tree entry to avoid the
overhead of using a generic strlen().</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authors"><a class="anchor" href="#_authors"></a>Authors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Written by Junio C Hamano &lt;<a href="mailto:gitster@pobox.com">gitster@pobox.com</a>&gt; and Linus Torvalds
&lt;<a href="mailto:torvalds@linux-foundation.org">torvalds@linux-foundation.org</a>&gt;</p>
</div>
</div>
</div>