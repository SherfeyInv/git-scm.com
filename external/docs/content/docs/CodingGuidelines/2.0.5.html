---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - CodingGuidelines Documentation
docname: CodingGuidelines
version: 2.0.5
aliases:
- "/docs/CodingGuidelines/2.0.5/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Like other projects, we also have some guidelines to keep to the
code.  For Git in general, three rough rules are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Most importantly, we never say "It&#8217;s in POSIX; we&#8217;ll happily
ignore your needs should your system not conform to it."
We live in the real world.</p>
</li>
<li>
<p>However, we often say "Let&#8217;s stay away from that construct,
it&#8217;s not even in POSIX".</p>
</li>
<li>
<p>In spite of the above two rules, we sometimes say "Although
this is not in POSIX, it (is so convenient | makes the code
much more readable | has other good characteristics) and
practically all the platforms we care about support it, so
let&#8217;s use it".</p>
<div class="literalblock">
<div class="content">
<pre>Again, we live in the real world, and it is sometimes a
judgement call, the decision based more on real world
constraints people face than what the paper standard says.</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Make your code readable and sensible, and don&#8217;t try to be clever.</p>
</div>
<div class="paragraph">
<p>As for more concrete guidelines, just imitate the existing code
(this is a good guideline, no matter which project you are
contributing to). It is always preferable to match the <em>local</em>
convention. New code added to Git suite is expected to match
the overall style of existing code. Modifications to existing
code is expected to match the style the surrounding code already
uses (even if it doesn&#8217;t match the overall style of existing code).</p>
</div>
<div class="paragraph">
<p>But if you must have a list of rules, here they are.</p>
</div>
<div class="paragraph">
<p>For shell scripts specifically (not exhaustive):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We use tabs for indentation.</p>
</li>
<li>
<p>Case arms are indented at the same depth as case and esac lines.</p>
</li>
<li>
<p>Redirection operators should be written with space before, but no
space after them.  In other words, write <em>echo test &gt;"$file"</em>
instead of <em>echo test&gt; $file</em> or <em>echo test &gt; $file</em>.  Note that
even though it is not required by POSIX to double-quote the
redirection target in a variable (as shown above), our code does so
because some versions of bash issue a warning without the quotes.</p>
</li>
<li>
<p>We prefer $( &#8230;&#8203; ) for command substitution; unlike ``, it
properly nests.  It should have been the way Bourne spelled
it from day one, but unfortunately isn&#8217;t.</p>
</li>
<li>
<p>If you want to find out if a command is available on the user&#8217;s
$PATH, you should use <em>type &lt;command&gt;</em>, instead of <em>which &lt;command&gt;</em>.
The output of <em>which</em> is not machine parseable and its exit code
is not reliable across platforms.</p>
</li>
<li>
<p>We use POSIX compliant parameter substitutions and avoid bashisms;
namely:</p>
</li>
<li>
<p>We use ${parameter-word} and its [-=?+] siblings, and their
colon&#8217;ed "unset or null" form.</p>
</li>
<li>
<p>We use ${parameter#word} and its [#%] siblings, and their
doubled "longest matching" form.</p>
</li>
<li>
<p>No "Substring Expansion" ${parameter:offset:length}.</p>
</li>
<li>
<p>No shell arrays.</p>
</li>
<li>
<p>No strlen ${#parameter}.</p>
</li>
<li>
<p>No pattern replacement ${parameter/pattern/string}.</p>
</li>
<li>
<p>We use Arithmetic Expansion $&#8230;&#8203;.</p>
</li>
<li>
<p>Inside Arithmetic Expansion, spell shell variables with $ in front
of them, as some shells do not grok $x while accepting $$x
just fine (e.g. dash older than 0.5.4).</p>
</li>
<li>
<p>We do not use Process Substitution &lt;(list) or &gt;(list).</p>
</li>
<li>
<p>Do not write control structures on a single line with semicolon.
"then" should be on the next line for if statements, and "do"
should be on the next line for "while" and "for".</p>
</li>
<li>
<p>We prefer "test" over "[ &#8230;&#8203; ]".</p>
</li>
<li>
<p>We do not write the noiseword "function" in front of shell
functions.</p>
</li>
<li>
<p>We prefer a space between the function name and the parentheses. The
opening "{" should also be on the same line.
E.g.: my_function () {</p>
</li>
<li>
<p>As to use of grep, stick to a subset of BRE (namely, no \{m,n\},
[::], [==], or [..]) for portability.</p>
</li>
<li>
<p>We do not use \{m,n\};</p>
</li>
<li>
<p>We do not use -E;</p>
</li>
<li>
<p>We do not use ? or + (which are \{0,1\} and \{1,\}
respectively in BRE) but that goes without saying as these
are ERE elements not BRE (note that \? and \+ are not even part
of BRE&#8201;&#8212;&#8201;making them accessible from BRE is a GNU extension).</p>
</li>
<li>
<p>Use Git&#8217;s gettext wrappers in git-sh-i18n to make the user
interface translatable. See "Marking strings for translation" in
po/README.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For C programs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We use tabs to indent, and interpret tabs as taking up to
8 spaces.</p>
</li>
<li>
<p>We try to keep to at most 80 characters per line.</p>
</li>
<li>
<p>We try to support a wide range of C compilers to compile Git with,
including old ones. That means that you should not use C99
initializers, even if a lot of compilers grok it.</p>
</li>
<li>
<p>Variables have to be declared at the beginning of the block.</p>
</li>
<li>
<p>NULL pointers shall be written as NULL, not as 0.</p>
</li>
<li>
<p>When declaring pointers, the star sides with the variable
name, i.e. "char <strong>string", not "char</strong> string" or
"char * string".  This makes it easier to understand code
like "char *string, c;".</p>
</li>
<li>
<p>Use whitespace around operators and keywords, but not inside
parentheses and not around functions. So:</p>
<div class="literalblock">
<div class="content">
<pre>      while (condition)
func(bar + 1);</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>and not:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>      while( condition )
func (bar+1);</pre>
</div>
</div>
</li>
<li>
<p>We avoid using braces unnecessarily.  I.e.</p>
<div class="literalblock">
<div class="content">
<pre>if (bla) {
	x = 1;
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>is frowned upon.  A gray area is when the statement extends
over a few lines, and/or you have a lengthy comment atop of
it.  Also, like in the Linux kernel, if there is a long list
of "else if" statements, it can make sense to add braces to
single line blocks.</pre>
</div>
</div>
</li>
<li>
<p>We try to avoid assignments inside if().</p>
</li>
<li>
<p>Try to make your code understandable.  You may put comments
in, but comments invariably tend to stale out when the code
they were describing changes.  Often splitting a function
into two makes the intention of the code much clearer.</p>
</li>
<li>
<p>Multi-line comments include their delimiters on separate lines from
the text.  E.g.</p>
<div class="literalblock">
<div class="content">
<pre>/*
 * A very long
 * multi-line comment.
 */</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Note however that a comment that explains a translatable string to
translators uses a convention of starting with a magic token
"TRANSLATORS: " immediately after the opening delimiter, even when
it spans multiple lines.  We do not add an asterisk at the beginning
of each line, either.  E.g.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>/* TRANSLATORS: here is a comment that explains the string
   to be translated, that follows immediately after it */
_("Here is a translatable string explained by the above.");</pre>
</div>
</div>
</li>
<li>
<p>Double negation is often harder to understand than no negation
at all.</p>
</li>
<li>
<p>Some clever tricks, like using the !! operator with arithmetic
constructs, can be extremely confusing to others.  Avoid them,
unless there is a compelling reason to use them.</p>
</li>
<li>
<p>Use the API.  No, really.  We have a strbuf (variable length
string), several arrays with the ALLOC_GROW() macro, a
string_list for sorted string lists, a hash map (mapping struct
objects) named "struct decorate", amongst other things.</p>
</li>
<li>
<p>When you come up with an API, document it.</p>
</li>
<li>
<p>The first #include in C files, except in platform specific
compat/ implementations, should be git-compat-util.h or another
header file that includes it, such as cache.h or builtin.h.</p>
</li>
<li>
<p>If you are planning a new command, consider writing it in shell
or perl first, so that changes in semantics can be easily
changed and discussed.  Many Git commands started out like
that, and a few are still scripts.</p>
</li>
<li>
<p>Avoid introducing a new dependency into Git. This means you
usually should stay away from scripting languages not already
used in the Git core command set (unless your command is clearly
separate from it, such as an importer to convert random-scm-X
repositories to Git).</p>
</li>
<li>
<p>When we pass &lt;string, length&gt; pair to functions, we should try to
pass them in that order.</p>
</li>
<li>
<p>Use Git&#8217;s gettext wrappers to make the user interface
translatable. See "Marking strings for translation" in po/README.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For Perl programs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Most of the C guidelines above apply.</p>
</li>
<li>
<p>We try to support Perl 5.8 and later ("use Perl 5.008").</p>
</li>
<li>
<p>use strict and use warnings are strongly preferred.</p>
</li>
<li>
<p>Don&#8217;t overuse statement modifiers unless using them makes the
result easier to follow.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>do something &#8230;&#8203;
do_this() unless (condition);</p>
</li>
<li>
<p>do something else &#8230;&#8203;</p>
<div class="literalblock">
<div class="content">
<pre>is more readable than:</pre>
</div>
</div>
</li>
<li>
<p>do something &#8230;&#8203;
unless (condition) {
	do_this();
}</p>
</li>
<li>
<p>do something else &#8230;&#8203;</p>
<div class="literalblock">
<div class="content">
<pre>*only* when the condition is so rare that do_this() will be almost
always called.</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>We try to avoid assignments inside "if ()" conditions.</p>
</li>
<li>
<p>Learn and use Git.pm if you need that functionality.</p>
</li>
<li>
<p>For Emacs, it&#8217;s useful to put the following in
GIT_CHECKOUT/.dir-locals.el, assuming you use cperl-mode:</p>
<div class="literalblock">
<div class="content">
<pre>;; note the first part is useful for C editing, too
((nil . ((indent-tabs-mode . t)
              (tab-width . 8)
              (fill-column . 80)))
 (cperl-mode . ((cperl-indent-level . 8)
                (cperl-extra-newline-before-brace . nil)
                (cperl-merge-trailing-else . t))))</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For Python scripts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We follow PEP-8 (<a href="http://www.python.org/dev/peps/pep-0008/" class="bare">http://www.python.org/dev/peps/pep-0008/</a>).</p>
</li>
<li>
<p>As a minimum, we aim to be compatible with Python 2.6 and 2.7.</p>
</li>
<li>
<p>Where required libraries do not restrict us to Python 2, we try to
also be compatible with Python 3.1 and later.</p>
</li>
<li>
<p>When you must differentiate between Unicode literals and byte string
literals, it is OK to use the <em>b</em> prefix.  Even though the Python
documentation for version 2.6 does not mention this prefix, it has
been supported since version 2.6.0.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Error Messages</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do not end error messages with a full stop.</p>
</li>
<li>
<p>Do not capitalize ("unable to open %s", not "Unable to open %s")</p>
</li>
<li>
<p>Say what the error is first ("cannot open %s", not "%s: cannot open")</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Writing Documentation:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Most (if not all) of the documentation pages are written in the
AsciiDoc format in *.txt files (e.g. Documentation/git.txt), and
processed into HTML and manpages (e.g. git.html and git.1 in the
same directory).</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>The documentation liberally mixes US and UK English (en_US/UK)
norms for spelling and grammar, which is somewhat unfortunate.
In an ideal world, it would have been better if it consistently
used only one and not the other, and we would have picked en_US
(if you wish to correct the English of some of the existing
documentation, please see the documentation-related advice in the
Documentation/SubmittingPatches file).</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Every user-visible change should be reflected in the documentation.
The same general rule as for code applies -- imitate the existing
conventions.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>A few commented examples follow to provide reference when writing or
modifying command usage strings and synopsis sections in the manual
pages:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Placeholders are spelled in lowercase and enclosed in angle brackets:
  &lt;file&gt;
  --sort=&lt;key&gt;
  --abbrev[=&lt;n&gt;]</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Possibility of multiple occurrences is indicated by three dots:
  &lt;file&gt;...
  (One or more of &lt;file&gt;.)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Optional parts are enclosed in square brackets:
  [&lt;extra&gt;]
  (Zero or one &lt;extra&gt;.)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>--exec-path[=&lt;path&gt;]
(Option with an optional argument.  Note that the "=" is inside the
brackets.)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>[&lt;patch&gt;...]
(Zero or more of &lt;patch&gt;.  Note that the dots are inside, not
outside the brackets.)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Multiple alternatives are indicated with vertical bar:
  [-q | --quiet]
  [--utf8 | --no-utf8]</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Parentheses are used for grouping:
  [(&lt;rev&gt;|&lt;range&gt;)...]
  (Any number of either &lt;rev&gt; or &lt;range&gt;.  Parens are needed to make
  it clear that "..." pertains to both &lt;rev&gt; and &lt;range&gt;.)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>[(-p &lt;parent&gt;)...]
(Any number of option -p, each with one &lt;parent&gt; argument.)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>git remote set-head &lt;name&gt; (-a | -d | &lt;branch&gt;)
(One and only one of "-a", "-d" or "&lt;branch&gt;" _must_ (no square
brackets) be provided.)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>And a somewhat more contrived example:
  --diff-filter=[(A|C|D|M|R|T|U|X|B)...[*]]
  Here "=" is outside the brackets, because "--diff-filter=" is a
  valid usage.  "*" has its own pair of brackets, because it can
  (optionally) be specified only when one or more of the letters is
  also provided.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>A note on notation:
 Use 'git' (all lowercase) when talking about commands i.e. something
 the user would type into a shell and use 'Git' (uppercase first letter)
 when talking about the version control system and its properties.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>A few commented examples follow to provide reference when writing or
modifying paragraphs or option/command explanations that contain options
or commands:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Literal examples (e.g. use of command-line options, command names, and
configuration variables) are typeset in monospace, and if you can use
`backticks around word phrases`, do so.
  `--pretty=oneline`
  `git rev-list`
  `remote.pushdefault`</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Word phrases enclosed in `backtick characters` are rendered literally
and will not be further expanded. The use of `backticks` to achieve the
previous rule means that literal examples should not use AsciiDoc
escapes.
  Correct:
     `--pretty=oneline`
  Incorrect:
     `\--pretty=oneline`</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>If some place in the documentation needs to typeset a command usage
example with inline substitutions, it is fine to use +monospaced and
inline substituted text+ instead of `monospaced literal text`, and with
the former, the part that should not get substituted must be
quoted/escaped.</pre>
</div>
</div>
</div>
</div>