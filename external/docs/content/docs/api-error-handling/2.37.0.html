---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - api-error-handling Documentation
docname: api-error-handling
version: 2.37.0
aliases:
- "/docs/api-error-handling/2.37.0/index.html"
- "/docs/api-error-handling/2.37.1/index.html"
- "/docs/api-error-handling/2.37.2/index.html"
- "/docs/api-error-handling/2.37.3/index.html"
- "/docs/api-error-handling/2.37.4/index.html"
- "/docs/api-error-handling/2.37.5/index.html"
- "/docs/api-error-handling/2.37.6/index.html"
- "/docs/api-error-handling/2.37.7/index.html"
- "/docs/api-error-handling/2.38.0/index.html"
- "/docs/api-error-handling/2.38.1/index.html"
- "/docs/api-error-handling/2.38.2/index.html"
- "/docs/api-error-handling/2.38.3/index.html"
- "/docs/api-error-handling/2.38.4/index.html"
- "/docs/api-error-handling/2.38.5/index.html"
- "/docs/api-error-handling/2.39.0/index.html"
- "/docs/api-error-handling/2.39.1/index.html"
- "/docs/api-error-handling/2.39.2/index.html"
- "/docs/api-error-handling/2.39.3/index.html"
- "/docs/api-error-handling/2.39.4/index.html"
- "/docs/api-error-handling/2.39.5/index.html"
- "/docs/api-error-handling/2.40.0/index.html"
- "/docs/api-error-handling/2.40.1/index.html"
- "/docs/api-error-handling/2.40.2/index.html"
- "/docs/api-error-handling/2.40.3/index.html"
- "/docs/api-error-handling/2.40.4/index.html"
- "/docs/api-error-handling/2.41.0/index.html"
- "/docs/api-error-handling/2.41.1/index.html"
- "/docs/api-error-handling/2.41.2/index.html"
- "/docs/api-error-handling/2.41.3/index.html"
- "/docs/api-error-handling/2.42.0/index.html"
- "/docs/api-error-handling/2.42.1/index.html"
- "/docs/api-error-handling/2.42.2/index.html"
- "/docs/api-error-handling/2.42.3/index.html"
- "/docs/api-error-handling/2.42.4/index.html"
- "/docs/api-error-handling/2.43.0/index.html"
- "/docs/api-error-handling/2.43.1/index.html"
- "/docs/api-error-handling/2.43.2/index.html"
- "/docs/api-error-handling/2.43.3/index.html"
- "/docs/api-error-handling/2.43.4/index.html"
- "/docs/api-error-handling/2.43.5/index.html"
- "/docs/api-error-handling/2.43.6/index.html"
- "/docs/api-error-handling/2.43.7/index.html"
- "/docs/api-error-handling/2.44.0/index.html"
- "/docs/api-error-handling/2.44.1/index.html"
- "/docs/api-error-handling/2.44.2/index.html"
- "/docs/api-error-handling/2.44.3/index.html"
- "/docs/api-error-handling/2.44.4/index.html"
- "/docs/api-error-handling/2.45.0/index.html"
- "/docs/api-error-handling/2.45.1/index.html"
- "/docs/api-error-handling/2.45.2/index.html"
- "/docs/api-error-handling/2.45.3/index.html"
- "/docs/api-error-handling/2.45.4/index.html"
- "/docs/api-error-handling/2.46.0/index.html"
- "/docs/api-error-handling/2.46.1/index.html"
- "/docs/api-error-handling/2.46.2/index.html"
- "/docs/api-error-handling/2.46.3/index.html"
- "/docs/api-error-handling/2.46.4/index.html"
- "/docs/api-error-handling/2.47.0/index.html"
- "/docs/api-error-handling/2.47.1/index.html"
- "/docs/api-error-handling/2.47.2/index.html"
- "/docs/api-error-handling/2.47.3/index.html"
- "/docs/api-error-handling/2.48.0/index.html"
- "/docs/api-error-handling/2.48.1/index.html"
- "/docs/api-error-handling/2.48.2/index.html"
- "/docs/api-error-handling/2.49.0/index.html"
- "/docs/api-error-handling/2.49.1/index.html"
- "/docs/api-error-handling/2.50.0/index.html"
- "/docs/api-error-handling/2.50.1/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><span class='synopsis'><code>BUG</code></span>, <span class='synopsis'><code>bug</code></span>, <span class='synopsis'><code>die</code></span>, <span class='synopsis'><code>usage</code></span>, <span class='synopsis'><code>error</code></span>, and <span class='synopsis'><code>warning</code></span> report errors of
various kinds.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class='synopsis'><code>BUG</code></span> is for failed internal assertions that should never happen,
i.e. a bug in git itself.</p>
</li>
<li>
<p><span class='synopsis'><code>bug</code></span> (lower-case, not <span class='synopsis'><code>BUG</code></span>) is supposed to be used like <span class='synopsis'><code>BUG</code></span> but
prints a "BUG" message instead of calling <span class='synopsis'><code>abort</code>()</span>.</p>
<div class="paragraph">
<p>A call to <span class='synopsis'><code>bug</code>()</span> will then result in a "real" call to the <span class='synopsis'><code>BUG</code>()</span>
function, either explicitly by invoking <span class='synopsis'><code>BUG_if_bug</code>()</span> after call(s)
to <span class='synopsis'><code>bug</code>()</span>, or implicitly at <span class='synopsis'><code>exit</code>()</span> time where we&#8217;ll check if we
encountered any outstanding <span class='synopsis'><code>bug</code>()</span> invocations.</p>
</div>
<div class="paragraph">
<p>If there were no prior calls to <span class='synopsis'><code>bug</code>()</span> before invoking <span class='synopsis'><code>BUG_if_bug</code>()</span>
the latter is a NOOP. The <span class='synopsis'><code>BUG_if_bug</code>()</span> function takes the same
arguments as <span class='synopsis'><code>BUG</code>()</span> itself. Calling <span class='synopsis'><code>BUG_if_bug</code>()</span> explicitly isn&#8217;t
necessary, but ensures that we die as soon as possible.</p>
</div>
<div class="paragraph">
<p>If you know you had prior calls to <span class='synopsis'><code>bug</code>()</span> then calling <span class='synopsis'><code>BUG</code>()</span> itself
is equivalent to calling <span class='synopsis'><code>BUG_if_bug</code>()</span>, the latter being a wrapper
calling <span class='synopsis'><code>BUG</code>()</span> if we&#8217;ve set a flag indicating that we&#8217;ve called
<span class='synopsis'><code>bug</code>()</span>.</p>
</div>
<div class="paragraph">
<p>This is for the convenience of APIs who&#8217;d like to potentially report
more than one "bug", such as the optbug() validation in
parse-options.c.</p>
</div>
</li>
<li>
<p><span class='synopsis'><code>die</code></span> is for fatal application errors.  It prints a message to
the user and exits with status 128.</p>
</li>
<li>
<p><span class='synopsis'><code>usage</code></span> is for errors in command line usage.  After printing its
message, it exits with status 129.  (See also <span class='synopsis'><code>usage_with_options</code></span>
in the <a href="{{< relurl "docs/api-parse-options" >}}">parse-options API</a>.)</p>
</li>
<li>
<p><span class='synopsis'><code>error</code></span> is for non-fatal library errors.  It prints a message
to the user and returns -1 for convenience in signaling the error
to the caller.</p>
</li>
<li>
<p><span class='synopsis'><code>warning</code></span> is for reporting situations that probably should not
occur but which the user (and Git) can continue to work around
without running into too many problems.  Like <span class='synopsis'><code>error</code></span>, it
returns -1 after reporting the situation to the caller.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These reports will be logged via the trace2 facility. See the "error"
event in <a href="{{< relurl "docs/api-trace2" >}}">trace2 API</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customizable_error_handlers"><a class="anchor" href="#_customizable_error_handlers"></a>Customizable error handlers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default behavior of <span class='synopsis'><code>die</code></span> and <span class='synopsis'><code>error</code></span> is to write a message to
stderr and then exit or return as appropriate.  This behavior can be
overridden using <span class='synopsis'><code>set_die_routine</code></span> and <span class='synopsis'><code>set_error_routine</code></span>.  For
example, "git daemon" uses set_die_routine to write the reason <span class='synopsis'><code>die</code></span>
was called to syslog before exiting.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_library_errors"><a class="anchor" href="#_library_errors"></a>Library errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Functions return a negative integer on error.  Details beyond that
vary from function to function:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some functions return -1 for all errors.  Others return a more
specific value depending on how the caller might want to react
to the error.</p>
</li>
<li>
<p>Some functions report the error to stderr with <span class='synopsis'><code>error</code></span>,
while others leave that for the caller to do.</p>
</li>
<li>
<p>errno is not meaningful on return from most functions (except
for thin wrappers for system calls).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Check the function&#8217;s API documentation to be sure.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_caller_handled_errors"><a class="anchor" href="#_caller_handled_errors"></a>Caller-handled errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An increasing number of functions take a parameter <em>struct strbuf *err</em>.
On error, such functions append a message about what went wrong to the
<em>err</em> strbuf.  The message is meant to be complete enough to be passed
to <span class='synopsis'><code>die</code></span> or <span class='synopsis'><code>error</code></span> as-is.  For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>if (ref_transaction_commit(transaction, &amp;err))
	die("%s", err.buf);</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>err</em> parameter will be untouched if no error occurred, so multiple
function calls can be chained:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>t = ref_transaction_begin(&amp;err);
if (!t ||
    ref_transaction_update(t, "HEAD", ..., &amp;err) ||
    ret_transaction_commit(t, &amp;err))
	die("%s", err.buf);</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>err</em> parameter must be a pointer to a valid strbuf.  To silence
a message, pass a strbuf that is explicitly ignored:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>if (thing_that_can_fail_in_an_ignorable_way(..., &amp;err))
	/* This failure is okay. */
	strbuf_reset(&amp;err);</pre>
</div>
</div>
</div>
</div>