---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - api-error-handling Documentation
docname: api-error-handling
version: 2.32.0
aliases:
- "/docs/api-error-handling/2.32.0/index.html"
- "/docs/api-error-handling/2.32.1/index.html"
- "/docs/api-error-handling/2.32.2/index.html"
- "/docs/api-error-handling/2.32.3/index.html"
- "/docs/api-error-handling/2.32.4/index.html"
- "/docs/api-error-handling/2.32.5/index.html"
- "/docs/api-error-handling/2.32.6/index.html"
- "/docs/api-error-handling/2.32.7/index.html"
- "/docs/api-error-handling/2.33.0/index.html"
- "/docs/api-error-handling/2.33.1/index.html"
- "/docs/api-error-handling/2.33.2/index.html"
- "/docs/api-error-handling/2.33.3/index.html"
- "/docs/api-error-handling/2.33.4/index.html"
- "/docs/api-error-handling/2.33.5/index.html"
- "/docs/api-error-handling/2.33.6/index.html"
- "/docs/api-error-handling/2.33.7/index.html"
- "/docs/api-error-handling/2.33.8/index.html"
- "/docs/api-error-handling/2.34.0/index.html"
- "/docs/api-error-handling/2.34.1/index.html"
- "/docs/api-error-handling/2.34.2/index.html"
- "/docs/api-error-handling/2.34.3/index.html"
- "/docs/api-error-handling/2.34.4/index.html"
- "/docs/api-error-handling/2.34.5/index.html"
- "/docs/api-error-handling/2.34.6/index.html"
- "/docs/api-error-handling/2.34.7/index.html"
- "/docs/api-error-handling/2.34.8/index.html"
- "/docs/api-error-handling/2.35.0/index.html"
- "/docs/api-error-handling/2.35.1/index.html"
- "/docs/api-error-handling/2.35.2/index.html"
- "/docs/api-error-handling/2.35.3/index.html"
- "/docs/api-error-handling/2.35.4/index.html"
- "/docs/api-error-handling/2.35.5/index.html"
- "/docs/api-error-handling/2.35.6/index.html"
- "/docs/api-error-handling/2.35.7/index.html"
- "/docs/api-error-handling/2.35.8/index.html"
- "/docs/api-error-handling/2.36.0/index.html"
- "/docs/api-error-handling/2.36.1/index.html"
- "/docs/api-error-handling/2.36.2/index.html"
- "/docs/api-error-handling/2.36.3/index.html"
- "/docs/api-error-handling/2.36.4/index.html"
- "/docs/api-error-handling/2.36.5/index.html"
- "/docs/api-error-handling/2.36.6/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><span class='synopsis'><code>BUG</code></span>, <span class='synopsis'><code>die</code></span>, <span class='synopsis'><code>usage</code></span>, <span class='synopsis'><code>error</code></span>, and <span class='synopsis'><code>warning</code></span> report errors of
various kinds.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class='synopsis'><code>BUG</code></span> is for failed internal assertions that should never happen,
i.e. a bug in git itself.</p>
</li>
<li>
<p><span class='synopsis'><code>die</code></span> is for fatal application errors.  It prints a message to
the user and exits with status 128.</p>
</li>
<li>
<p><span class='synopsis'><code>usage</code></span> is for errors in command line usage.  After printing its
message, it exits with status 129.  (See also <span class='synopsis'><code>usage_with_options</code></span>
in the <a href="{{< relurl "docs/api-parse-options" >}}">parse-options API</a>.)</p>
</li>
<li>
<p><span class='synopsis'><code>error</code></span> is for non-fatal library errors.  It prints a message
to the user and returns -1 for convenience in signaling the error
to the caller.</p>
</li>
<li>
<p><span class='synopsis'><code>warning</code></span> is for reporting situations that probably should not
occur but which the user (and Git) can continue to work around
without running into too many problems.  Like <span class='synopsis'><code>error</code></span>, it
returns -1 after reporting the situation to the caller.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These reports will be logged via the trace2 facility. See the "error"
event in <a href="{{< relurl "docs/api-trace2" >}}">trace2 API</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customizable_error_handlers"><a class="anchor" href="#_customizable_error_handlers"></a>Customizable error handlers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default behavior of <span class='synopsis'><code>die</code></span> and <span class='synopsis'><code>error</code></span> is to write a message to
stderr and then exit or return as appropriate.  This behavior can be
overridden using <span class='synopsis'><code>set_die_routine</code></span> and <span class='synopsis'><code>set_error_routine</code></span>.  For
example, "git daemon" uses set_die_routine to write the reason <span class='synopsis'><code>die</code></span>
was called to syslog before exiting.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_library_errors"><a class="anchor" href="#_library_errors"></a>Library errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Functions return a negative integer on error.  Details beyond that
vary from function to function:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some functions return -1 for all errors.  Others return a more
specific value depending on how the caller might want to react
to the error.</p>
</li>
<li>
<p>Some functions report the error to stderr with <span class='synopsis'><code>error</code></span>,
while others leave that for the caller to do.</p>
</li>
<li>
<p>errno is not meaningful on return from most functions (except
for thin wrappers for system calls).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Check the function&#8217;s API documentation to be sure.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_caller_handled_errors"><a class="anchor" href="#_caller_handled_errors"></a>Caller-handled errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An increasing number of functions take a parameter <em>struct strbuf *err</em>.
On error, such functions append a message about what went wrong to the
<em>err</em> strbuf.  The message is meant to be complete enough to be passed
to <span class='synopsis'><code>die</code></span> or <span class='synopsis'><code>error</code></span> as-is.  For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>if (ref_transaction_commit(transaction, &amp;err))
	die("%s", err.buf);</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>err</em> parameter will be untouched if no error occurred, so multiple
function calls can be chained:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>t = ref_transaction_begin(&amp;err);
if (!t ||
    ref_transaction_update(t, "HEAD", ..., &amp;err) ||
    ret_transaction_commit(t, &amp;err))
	die("%s", err.buf);</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>err</em> parameter must be a pointer to a valid strbuf.  To silence
a message, pass a strbuf that is explicitly ignored:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>if (thing_that_can_fail_in_an_ignorable_way(..., &amp;err))
	/* This failure is okay. */
	strbuf_reset(&amp;err);</pre>
</div>
</div>
</div>
</div>