---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - api-trace Documentation
docname: api-trace
version: 2.1.4
aliases:
- "/docs/api-trace/2.1.4/index.html"
- "/docs/api-trace/2.2.3/index.html"
- "/docs/api-trace/2.3.10/index.html"
- "/docs/api-trace/2.4.12/index.html"
- "/docs/api-trace/2.5.6/index.html"
- "/docs/api-trace/2.6.7/index.html"
- "/docs/api-trace/2.7.6/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The trace API can be used to print debug messages to stderr or a file. Trace
code is inactive unless explicitly enabled by setting <span class='synopsis'><code>GIT_TRACE*</code></span> environment
variables.</p>
</div>
<div class="paragraph">
<p>The trace implementation automatically adds <span class='synopsis'><em>timestamp file:line ... \n</em></span> to
all trace messages. E.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>23:59:59.123456 git.c:312               trace: built-in: git 'foo'
00:00:00.000001 builtin/foo.c:99        foo: some message</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_structures"><a class="anchor" href="#_data_structures"></a>Data Structures</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodestructcodecodetracekeycodespan"><a id="Documentation/technical/api-trace.txt-structtracekey" class="anchor" href="#Documentation/technical/api-trace.txt-structtracekey"></a><span class='synopsis'><code>struct</code> <code>trace_key</code></span> </dt>
<dd>
<p>Defines a trace key (or category). The default (for API functions that
don&#8217;t take a key) is <span class='synopsis'><code>GIT_TRACE</code></span>.</p>
<div class="paragraph">
<p>E.g. to define a trace key controlled by environment variable <span class='synopsis'><code>GIT_TRACE_FOO</code></span>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>static struct trace_key trace_foo = TRACE_KEY_INIT(FOO);

static void trace_print_foo(const char *message)
{
	trace_print_key(&amp;trace_foo, message);
}</pre>
</div>
</div>
<div class="paragraph">
<p>Note: don&#8217;t use <span class='synopsis'><code>const</code></span> as the trace implementation stores internal state in
the <span class='synopsis'><code>trace_key</code></span> structure.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functions"><a class="anchor" href="#_functions"></a>Functions</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodeintcodecodetracewantcodecodestructcodecodetracekeycodecodekeycodespan"><a id="Documentation/technical/api-trace.txt-inttracewantstructtracekeykey" class="anchor" href="#Documentation/technical/api-trace.txt-inttracewantstructtracekeykey"></a><span class='synopsis'><code>int</code> <code>trace_want</code>(<code>struct</code> <code>trace_key</code> <code>*key</code>)</span> </dt>
<dd>
<p>Checks whether the trace key is enabled. Used to prevent expensive
string formatting before calling one of the printing APIs.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodevoidcodecodetracedisablecodecodestructcodecodetracekeycodecodekeycodespan"><a id="Documentation/technical/api-trace.txt-voidtracedisablestructtracekeykey" class="anchor" href="#Documentation/technical/api-trace.txt-voidtracedisablestructtracekeykey"></a><span class='synopsis'><code>void</code> <code>trace_disable</code>(<code>struct</code> <code>trace_key</code> <code>*key</code>)</span> </dt>
<dd>
<p>Disables tracing for the specified key, even if the environment
variable was set.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodevoidcodecodetraceprintfcodecodeconstcodecodecharcodecodeformatcodecodecodespan"><a id="Documentation/technical/api-trace.txt-voidtraceprintfconstcharformat" class="anchor" href="#Documentation/technical/api-trace.txt-voidtraceprintfconstcharformat"></a><span class='synopsis'><code>void</code> <code>trace_printf</code>(<code>const</code> <code>char</code> <code>*format,</code> <code>...</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodevoidcodecodetraceprintfkeycodecodestructcodecodetracekeycodecodekeycodecodeconstcodecodecharcodecodeformatcodecodecodespan"><a id="Documentation/technical/api-trace.txt-voidtraceprintfkeystructtracekeykeyconstcharformat" class="anchor" href="#Documentation/technical/api-trace.txt-voidtraceprintfkeystructtracekeykeyconstcharformat"></a><span class='synopsis'><code>void</code> <code>trace_printf_key</code>(<code>struct</code> <code>trace_key</code> <code>*key,</code> <code>const</code> <code>char</code> <code>*format,</code> <code>...</code>)</span> </dt>
<dd>
<p>Prints a formatted message, similar to printf.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodevoidcodecodetraceargvprintfcodecodeconstcodecodecharcodecodeargvcodecodeconstcodecodecharcodecodeformatcodecodecodespan"><a id="Documentation/technical/api-trace.txt-voidtraceargvprintfconstcharargvconstcharformat" class="anchor" href="#Documentation/technical/api-trace.txt-voidtraceargvprintfconstcharargvconstcharformat"></a><span class='synopsis'><code>void</code> <code>trace_argv_printf</code>(<code>const</code> <code>char</code> <code>**argv,</code> <code>const</code> <code>char</code> <code>*format,</code> <code>...</code>)</span> </dt>
<dd>
<p>Prints a formatted message, followed by a quoted list of arguments.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodevoidcodecodetracestrbufcodecodestructcodecodetracekeycodecodekeycodecodeconstcodecodestructcodecodestrbufcodecodedatacodespan"><a id="Documentation/technical/api-trace.txt-voidtracestrbufstructtracekeykeyconststructstrbufdata" class="anchor" href="#Documentation/technical/api-trace.txt-voidtracestrbufstructtracekeykeyconststructstrbufdata"></a><span class='synopsis'><code>void</code> <code>trace_strbuf</code>(<code>struct</code> <code>trace_key</code> <code>*key,</code> <code>const</code> <code>struct</code> <code>strbuf</code> <code>*data</code>)</span> </dt>
<dd>
<p>Prints the strbuf, without additional formatting (i.e. doesn&#8217;t
choke on <span class='synopsis'><code>%</code></span> or even <span class='synopsis'><em>\0</em></span>).</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodeuint64tcodecodegetnanotimecodecodevoidcodespan"><a id="Documentation/technical/api-trace.txt-uint64tgetnanotimevoid" class="anchor" href="#Documentation/technical/api-trace.txt-uint64tgetnanotimevoid"></a><span class='synopsis'><code>uint64_t</code> <code>getnanotime</code>(<code>void</code>)</span> </dt>
<dd>
<p>Returns nanoseconds since the epoch (01/01/1970), typically used
for performance measurements.</p>
<div class="paragraph">
<p>Currently there are high precision timer implementations for Linux (using
<span class='synopsis'><code>clock_gettime</code>(<code>CLOCK_MONOTONIC</code>)</span>) and Windows (<span class='synopsis'><code>QueryPerformanceCounter</code></span>).
Other platforms use <span class='synopsis'><code>gettimeofday</code></span> as time source.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodevoidcodecodetraceperformancecodecodeuint64tcodecodenanoscodecodeconstcodecodecharcodecodeformatcodecodecodespan"><a id="Documentation/technical/api-trace.txt-voidtraceperformanceuint64tnanosconstcharformat" class="anchor" href="#Documentation/technical/api-trace.txt-voidtraceperformanceuint64tnanosconstcharformat"></a><span class='synopsis'><code>void</code> <code>trace_performance</code>(<code>uint64_t</code> <code>nanos,</code> <code>const</code> <code>char</code> <code>*format,</code> <code>...</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-trace.txt-spanclasssynopsiscodevoidcodecodetraceperformancesincecodecodeuint64tcodecodestartcodecodeconstcodecodecharcodecodeformatcodecodecodespan"><a id="Documentation/technical/api-trace.txt-voidtraceperformancesinceuint64tstartconstcharformat" class="anchor" href="#Documentation/technical/api-trace.txt-voidtraceperformancesinceuint64tstartconstcharformat"></a><span class='synopsis'><code>void</code> <code>trace_performance_since</code>(<code>uint64_t</code> <code>start,</code> <code>const</code> <code>char</code> <code>*format,</code> <code>...</code>)</span> </dt>
<dd>
<p>Prints the elapsed time (in nanoseconds), or elapsed time since
<span class='synopsis'><code>start</code></span>, followed by a formatted message. Enabled via environment
variable <span class='synopsis'><code>GIT_TRACE_PERFORMANCE</code></span>. Used for manual profiling, e.g.:</p>
<div class="listingblock">
<div class="content">
<pre>uint64_t start = getnanotime();
/* code section to measure */
trace_performance_since(start, "foobar");</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>uint64_t t = 0;
for (;;) {
	/* ignore */
	t -= getnanotime();
	/* code section to measure */
	t += getnanotime();
	/* ignore */
}
trace_performance(t, "frotz");</pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>