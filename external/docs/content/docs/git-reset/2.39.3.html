---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - git-reset Documentation
docname: git-reset
version: 2.39.3
aliases:
- "/docs/git-reset/2.39.3/index.html"
- "/docs/git-reset/2.39.4/index.html"
- "/docs/git-reset/2.39.5/index.html"
- "/docs/git-reset/2.40.0/index.html"
- "/docs/git-reset/2.40.1/index.html"
- "/docs/git-reset/2.40.2/index.html"
- "/docs/git-reset/2.40.3/index.html"
- "/docs/git-reset/2.40.4/index.html"
- "/docs/git-reset/2.41.0/index.html"
- "/docs/git-reset/2.41.1/index.html"
- "/docs/git-reset/2.41.2/index.html"
- "/docs/git-reset/2.41.3/index.html"
- "/docs/git-reset/2.42.0/index.html"
- "/docs/git-reset/2.42.1/index.html"
- "/docs/git-reset/2.42.2/index.html"
- "/docs/git-reset/2.42.3/index.html"
- "/docs/git-reset/2.42.4/index.html"
- "/docs/git-reset/2.43.0/index.html"
- "/docs/git-reset/2.43.1/index.html"
- "/docs/git-reset/2.43.2/index.html"
- "/docs/git-reset/2.43.3/index.html"
- "/docs/git-reset/2.43.4/index.html"
- "/docs/git-reset/2.43.5/index.html"
- "/docs/git-reset/2.43.6/index.html"
- "/docs/git-reset/2.44.0/index.html"
- "/docs/git-reset/2.44.1/index.html"
- "/docs/git-reset/2.44.2/index.html"
- "/docs/git-reset/2.44.3/index.html"
- "/docs/git-reset/2.45.0/index.html"
- "/docs/git-reset/2.45.1/index.html"
- "/docs/git-reset/2.45.2/index.html"
- "/docs/git-reset/2.45.3/index.html"
- "/docs/git-reset/2.46.0/index.html"
- "/docs/git-reset/2.46.1/index.html"
- "/docs/git-reset/2.46.2/index.html"
- "/docs/git-reset/2.46.3/index.html"
- "/docs/git-reset/2.47.0/index.html"
- "/docs/git-reset/2.47.1/index.html"
- "/docs/git-reset/2.47.2/index.html"
- "/docs/git-reset/2.48.0/index.html"
- "/docs/git-reset/2.48.1/index.html"
- "/docs/git-reset/2.49.0/index.html"
---
<div class="sect1">
<h2 id="_name"><a class="anchor" href="#_name"></a>NAME</h2>
<div class="sectionbody">
<div class="paragraph">
<p>git-reset - Reset current HEAD to the specified state</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis"><a class="anchor" href="#_synopsis"></a>SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content"><em>git reset</em> [-q] [&lt;tree-ish&gt;] [--] &lt;pathspec&gt;&#8230;&#8203;
<em>git reset</em> [-q] [--pathspec-from-file=&lt;file&gt; [--pathspec-file-nul]] [&lt;tree-ish&gt;]
<em>git reset</em> (--patch | -p) [&lt;tree-ish&gt;] [--] [&lt;pathspec&gt;&#8230;&#8203;]
<em>git reset</em> [--soft | --mixed [-N] | --hard | --merge | --keep] [-q] [&lt;commit&gt;]</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_description"><a class="anchor" href="#_description"></a>DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the first three forms, copy entries from <span class='synopsis'><em>&lt;tree-ish&gt;</em></span> to the index.
In the last form, set the current branch head (<span class='synopsis'><code>HEAD</code></span>) to <span class='synopsis'><em>&lt;commit&gt;</em></span>,
optionally modifying index and working tree to match.
The <span class='synopsis'><em>&lt;tree-ish&gt;</em></span>/<span class='synopsis'><em>&lt;commit&gt;</em></span> defaults to <span class='synopsis'><code>HEAD</code></span> in all forms.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/git-reset.txt-emgitresetem-qlttree-ishgt--ltpathspecgt82308203"><a id="Documentation/git-reset.txt-gitreset-qtree-ish--pathspec" class="anchor" href="#Documentation/git-reset.txt-gitreset-qtree-ish--pathspec"></a><em>git reset</em> [-q] [&lt;tree-ish&gt;] [--] &lt;pathspec&gt;&#8230;&#8203; </dt>
<dt class="hdlist1" id="Documentation/git-reset.txt-emgitresetem-q--pathspec-from-fileltfilegt--pathspec-file-nullttree-ishgt"><a id="Documentation/git-reset.txt-gitreset-q--pathspec-from-filefile--pathspec-file-nultree-ish" class="anchor" href="#Documentation/git-reset.txt-gitreset-q--pathspec-from-filefile--pathspec-file-nultree-ish"></a><em>git reset</em> [-q] [--pathspec-from-file=&lt;file&gt; [--pathspec-file-nul]] [&lt;tree-ish&gt;] </dt>
<dd>
<p>These forms reset the index entries for all paths that match the
<span class='synopsis'><em>&lt;pathspec&gt;</em></span> to their state at <span class='synopsis'><em>&lt;tree-ish&gt;</em></span>.  (It does not affect
the working tree or the current branch.)</p>
<div class="paragraph">
<p>This means that <span class='synopsis'><code>git</code> <code>reset</code> <em>&lt;pathspec&gt;</em></span> is the opposite of <span class='synopsis'><code>git</code> <code>add</code>

<em>&lt;pathspec&gt;</em></span>. This command is equivalent to
<span class='synopsis'><code>git</code> <code>restore</code> [<code>--source=</code><em>&lt;tree-ish&gt;</em>] <code>--staged</code> <em>&lt;pathspec&gt;</em>...</span>.</p>
</div>
<div class="paragraph">
<p>After running <span class='synopsis'><code>git</code> <code>reset</code> <em>&lt;pathspec&gt;</em></span> to update the index entry, you can
use <a href='{{< relurl "docs/git-restore" >}}'>git-restore[1]</a> to check the contents out of the index to
the working tree. Alternatively, using <a href='{{< relurl "docs/git-restore" >}}'>git-restore[1]</a>
and specifying a commit with <span class='synopsis'><code>--source</code></span>, you
can copy the contents of a path out of a commit to the index and to the
working tree in one go.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-emgitresetem--patch-plttree-ishgt--ltpathspecgt82308203"><a id="Documentation/git-reset.txt-gitreset--patch-ptree-ish--pathspec" class="anchor" href="#Documentation/git-reset.txt-gitreset--patch-ptree-ish--pathspec"></a><em>git reset</em> (--patch | -p) [&lt;tree-ish&gt;] [--] [&lt;pathspec&gt;&#8230;&#8203;] </dt>
<dd>
<p>Interactively select hunks in the difference between the index
and <span class='synopsis'><em>&lt;tree-ish&gt;</em></span> (defaults to <span class='synopsis'><code>HEAD</code></span>).  The chosen hunks are applied
in reverse to the index.</p>
<div class="paragraph">
<p>This means that <span class='synopsis'><code>git</code> <code>reset</code> <code>-p</code></span> is the opposite of <span class='synopsis'><code>git</code> <code>add</code> <code>-p</code></span>, i.e.
you can use it to selectively reset hunks. See the &#8220;Interactive Mode&#8221;
section of <a href='{{< relurl "docs/git-add" >}}'>git-add[1]</a> to learn how to operate the <span class='synopsis'><code>--patch</code></span> mode.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-emgitresetemltmodegtltcommitgt"><a id="Documentation/git-reset.txt-gitresetmodecommit" class="anchor" href="#Documentation/git-reset.txt-gitresetmodecommit"></a><em>git reset</em> [&lt;mode&gt;] [&lt;commit&gt;] </dt>
<dd>
<p>This form resets the current branch head to <span class='synopsis'><em>&lt;commit&gt;</em></span> and
possibly updates the index (resetting it to the tree of <span class='synopsis'><em>&lt;commit&gt;</em></span>) and
the working tree depending on <span class='synopsis'><em>&lt;mode&gt;</em></span>. Before the operation, <span class='synopsis'><code>ORIG_HEAD</code></span>
is set to the tip of the current branch. If <span class='synopsis'><em>&lt;mode&gt;</em></span> is omitted,
defaults to <span class='synopsis'><code>--mixed</code></span>. The <span class='synopsis'><em>&lt;mode&gt;</em></span> must be one of the following:</p>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/git-reset.txt---soft"><a class="anchor" href="#Documentation/git-reset.txt---soft"></a>--soft </dt>
<dd>
<p>Does not touch the index file or the working tree at all (but
resets the head to <span class='synopsis'><em>&lt;commit&gt;</em></span>, just like all modes do). This leaves
all your changed files "Changes to be committed", as <span class='synopsis'><code>git</code> <code>status</code></span>
would put it.</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---mixed"><a class="anchor" href="#Documentation/git-reset.txt---mixed"></a>--mixed </dt>
<dd>
<p>Resets the index but not the working tree (i.e., the changed files
are preserved but not marked for commit) and reports what has not
been updated. This is the default action.</p>
<div class="paragraph">
<p>If <span class='synopsis'><code>-N</code></span> is specified, removed paths are marked as intent-to-add (see
<a href='{{< relurl "docs/git-add" >}}'>git-add[1]</a>).</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---hard"><a class="anchor" href="#Documentation/git-reset.txt---hard"></a>--hard </dt>
<dd>
<p>Resets the index and working tree. Any changes to tracked files in the
working tree since <span class='synopsis'><em>&lt;commit&gt;</em></span> are discarded.  Any untracked files or
directories in the way of writing any tracked files are simply deleted.</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---merge"><a class="anchor" href="#Documentation/git-reset.txt---merge"></a>--merge </dt>
<dd>
<p>Resets the index and updates the files in the working tree that are
different between <span class='synopsis'><em>&lt;commit&gt;</em></span> and <span class='synopsis'><code>HEAD</code></span>, but keeps those which are
different between the index and working tree (i.e. which have changes
which have not been added).
If a file that is different between <span class='synopsis'><em>&lt;commit&gt;</em></span> and the index has
unstaged changes, reset is aborted.</p>
<div class="paragraph">
<p>In other words, <span class='synopsis'><code>--merge</code></span> does something like a <span class='synopsis'><code>git</code> <code>read-tree</code> <code>-u</code> <code>-m</code> <em>&lt;commit&gt;</em></span>,
but carries forward unmerged index entries.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---keep"><a class="anchor" href="#Documentation/git-reset.txt---keep"></a>--keep </dt>
<dd>
<p>Resets index entries and updates files in the working tree that are
different between <span class='synopsis'><em>&lt;commit&gt;</em></span> and <span class='synopsis'><code>HEAD</code></span>.
If a file that is different between <span class='synopsis'><em>&lt;commit&gt;</em></span> and <span class='synopsis'><code>HEAD</code></span> has local
changes, reset is aborted.</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---no-recurse-submodules"><a class="anchor" href="#Documentation/git-reset.txt---no-recurse-submodules"></a>--[no-]recurse-submodules </dt>
<dd>
<p>When the working tree is updated, using --recurse-submodules will
also recursively reset the working tree of all active submodules
according to the commit recorded in the superproject, also setting
the submodules' HEAD to be detached at that commit.</p>
</dd>
</dl>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See "Reset, restore and revert" in <a href='{{< relurl "docs/git" >}}'>git[1]</a> for the differences
between the three commands.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_options"><a class="anchor" href="#_options"></a>OPTIONS</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/git-reset.txt--q"><a class="anchor" href="#Documentation/git-reset.txt--q"></a>-q </dt>
<dt class="hdlist1" id="Documentation/git-reset.txt---quiet"><a class="anchor" href="#Documentation/git-reset.txt---quiet"></a>--quiet </dt>
<dd>
<p>Be quiet, only report errors.</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---refresh"><a class="anchor" href="#Documentation/git-reset.txt---refresh"></a>--refresh </dt>
<dt class="hdlist1" id="Documentation/git-reset.txt---no-refresh"><a class="anchor" href="#Documentation/git-reset.txt---no-refresh"></a>--no-refresh </dt>
<dd>
<p>Refresh the index after a mixed reset. Enabled by default.</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---pathspec-from-fileltfilegt"><a id="Documentation/git-reset.txt---pathspec-from-filefile" class="anchor" href="#Documentation/git-reset.txt---pathspec-from-filefile"></a>--pathspec-from-file=&lt;file&gt; </dt>
<dd>
<p>Pathspec is passed in <span class='synopsis'><em>&lt;file&gt;</em></span> instead of commandline args. If
<span class='synopsis'><em>&lt;file&gt;</em></span> is exactly <span class='synopsis'><code>-</code></span> then standard input is used. Pathspec
elements are separated by LF or CR/LF. Pathspec elements can be
quoted as explained for the configuration variable <span class='synopsis'><code>core.quotePath</code></span>
(see <a href='{{< relurl "docs/git-config" >}}'>git-config[1]</a>). See also <span class='synopsis'><code>--pathspec-file-nul</code></span> and
global <span class='synopsis'><code>--literal-pathspecs</code></span>.</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---pathspec-file-nul"><a class="anchor" href="#Documentation/git-reset.txt---pathspec-file-nul"></a>--pathspec-file-nul </dt>
<dd>
<p>Only meaningful with <span class='synopsis'><code>--pathspec-from-file</code></span>. Pathspec elements are
separated with NUL character and all other characters are taken
literally (including newlines and quotes).</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt---"><a class="anchor" href="#Documentation/git-reset.txt---"></a>-- </dt>
<dd>
<p>Do not interpret any more arguments as options.</p>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-ltpathspecgt82308203"><a id="Documentation/git-reset.txt-pathspec" class="anchor" href="#Documentation/git-reset.txt-pathspec"></a>&lt;pathspec&gt;&#8230;&#8203; </dt>
<dd>
<p>Limits the paths affected by the operation.</p>
<div class="paragraph">
<p>For more details, see the <em>pathspec</em> entry in <a href='{{< relurl "docs/gitglossary" >}}'>gitglossary[7]</a>.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples"><a class="anchor" href="#_examples"></a>EXAMPLES</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/git-reset.txt-Undoadd"><a class="anchor" href="#Documentation/git-reset.txt-Undoadd"></a>Undo add </dt>
<dd>
<div class="listingblock">
<div class="content">
<pre>$ edit                                     <b class="conum">(1)</b>
$ git add frotz.c filfre.c
$ mailx                                    <b class="conum">(2)</b>
$ git reset                                <b class="conum">(3)</b>
$ git pull git://info.example.com/ nitfol  <b class="conum">(4)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>You are happily working on something, and find the changes
in these files are in good order.  You do not want to see them
when you run <span class='synopsis'><code>git</code> <code>diff</code></span>, because you plan to work on other files
and changes with these files are distracting.</p>
</li>
<li>
<p>Somebody asks you to pull, and the changes sound worthy of merging.</p>
</li>
<li>
<p>However, you already dirtied the index (i.e. your index does
not match the <span class='synopsis'><code>HEAD</code></span> commit).  But you know the pull you are going
to make does not affect <span class='synopsis'><code>frotz.c</code></span> or <span class='synopsis'><code>filfre.c</code></span>, so you revert the
index changes for these two files.  Your changes in working tree
remain there.</p>
</li>
<li>
<p>Then you can pull and merge, leaving <span class='synopsis'><code>frotz.c</code></span> and <span class='synopsis'><code>filfre.c</code></span>
changes still in the working tree.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Undoacommitandredo"><a class="anchor" href="#Documentation/git-reset.txt-Undoacommitandredo"></a>Undo a commit and redo </dt>
<dd>
<div class="listingblock">
<div class="content">
<pre>$ git commit ...
$ git reset --soft HEAD^      <b class="conum">(1)</b>
$ edit                        <b class="conum">(2)</b>
$ git commit -a -c ORIG_HEAD  <b class="conum">(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This is most often done when you remembered what you
just committed is incomplete, or you misspelled your commit
message, or both.  Leaves working tree as it was before "reset".</p>
</li>
<li>
<p>Make corrections to working tree files.</p>
</li>
<li>
<p>"reset" copies the old head to <span class='synopsis'><code>.git/ORIG_HEAD</code></span>; redo the
commit by starting with its log message.  If you do not need to
edit the message further, you can give <span class='synopsis'><code>-C</code></span> option instead.</p>
<div class="paragraph">
<p>See also the <span class='synopsis'><code>--amend</code></span> option to <a href='{{< relurl "docs/git-commit" >}}'>git-commit[1]</a>.</p>
</div>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Undoacommitmakingitatopicbranch"><a class="anchor" href="#Documentation/git-reset.txt-Undoacommitmakingitatopicbranch"></a>Undo a commit, making it a topic branch </dt>
<dd>
<div class="listingblock">
<div class="content">
<pre>$ git branch topic/wip          <b class="conum">(1)</b>
$ git reset --hard HEAD~3       <b class="conum">(2)</b>
$ git switch topic/wip          <b class="conum">(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>You have made some commits, but realize they were premature
to be in the <span class='synopsis'><code>master</code></span> branch.  You want to continue polishing
them in a topic branch, so create <span class='synopsis'><code>topic/wip</code></span> branch off of the
current <span class='synopsis'><code>HEAD</code></span>.</p>
</li>
<li>
<p>Rewind the master branch to get rid of those three commits.</p>
</li>
<li>
<p>Switch to <span class='synopsis'><code>topic/wip</code></span> branch and keep working.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Undocommitspermanently"><a class="anchor" href="#Documentation/git-reset.txt-Undocommitspermanently"></a>Undo commits permanently </dt>
<dd>
<div class="listingblock">
<div class="content">
<pre>$ git commit ...
$ git reset --hard HEAD~3   <b class="conum">(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The last three commits (<span class='synopsis'><code>HEAD</code></span>, <span class='synopsis'><code>HEAD^</code></span>, and <span class='synopsis'><code>HEAD~2</code></span>) were bad
and you do not want to ever see them again.  Do <strong>not</strong> do this if
you have already given these commits to somebody else.  (See the
"RECOVERING FROM UPSTREAM REBASE" section in <a href='{{< relurl "docs/git-rebase" >}}'>git-rebase[1]</a>
for the implications of doing so.)</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Undoamergeorpull"><a class="anchor" href="#Documentation/git-reset.txt-Undoamergeorpull"></a>Undo a merge or pull </dt>
<dd>
<div class="listingblock">
<div class="content">
<pre>$ git pull                         <b class="conum">(1)</b>
Auto-merging nitfol
CONFLICT (content): Merge conflict in nitfol
Automatic merge failed; fix conflicts and then commit the result.
$ git reset --hard                 <b class="conum">(2)</b>
$ git pull . topic/branch          <b class="conum">(3)</b>
Updating from 41223... to 13134...
Fast-forward
$ git reset --hard ORIG_HEAD       <b class="conum">(4)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Try to update from the upstream resulted in a lot of
conflicts; you were not ready to spend a lot of time merging
right now, so you decide to do that later.</p>
</li>
<li>
<p>"pull" has not made merge commit, so <span class='synopsis'><code>git</code> <code>reset</code> <code>--hard</code></span>
which is a synonym for <span class='synopsis'><code>git</code> <code>reset</code> <code>--hard</code> <code>HEAD</code></span> clears the mess
from the index file and the working tree.</p>
</li>
<li>
<p>Merge a topic branch into the current branch, which resulted
in a fast-forward.</p>
</li>
<li>
<p>But you decided that the topic branch is not ready for public
consumption yet.  "pull" or "merge" always leaves the original
tip of the current branch in <span class='synopsis'><code>ORIG_HEAD</code></span>, so resetting hard to it
brings your index file and the working tree back to that state,
and resets the tip of the branch to that commit.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Undoamergeorpullinsideadirtyworkingtree"><a class="anchor" href="#Documentation/git-reset.txt-Undoamergeorpullinsideadirtyworkingtree"></a>Undo a merge or pull inside a dirty working tree </dt>
<dd>
<div class="listingblock">
<div class="content">
<pre>$ git pull                         <b class="conum">(1)</b>
Auto-merging nitfol
Merge made by recursive.
 nitfol                |   20 +++++----
 ...
$ git reset --merge ORIG_HEAD      <b class="conum">(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Even if you may have local modifications in your
working tree, you can safely say <span class='synopsis'><code>git</code> <code>pull</code></span> when you know
that the change in the other branch does not overlap with
them.</p>
</li>
<li>
<p>After inspecting the result of the merge, you may find
that the change in the other branch is unsatisfactory.  Running
<span class='synopsis'><code>git</code> <code>reset</code> <code>--hard</code> <code>ORIG_HEAD</code></span> will let you go back to where you
were, but it will discard your local changes, which you do not
want.  <span class='synopsis'><code>git</code> <code>reset</code> <code>--merge</code></span> keeps your local changes.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Interruptedworkflow"><a class="anchor" href="#Documentation/git-reset.txt-Interruptedworkflow"></a>Interrupted workflow </dt>
<dd>
<div class="paragraph">
<p>Suppose you are interrupted by an urgent fix request while you
are in the middle of a large change.  The files in your
working tree are not in any shape to be committed yet, but you
need to get to the other branch for a quick bugfix.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git switch feature  ;# you were working in "feature" branch and
$ work work work      ;# got interrupted
$ git commit -a -m "snapshot WIP"                 <b class="conum">(1)</b>
$ git switch master
$ fix fix fix
$ git commit ;# commit with real log
$ git switch feature
$ git reset --soft HEAD^ ;# go back to WIP state  <b class="conum">(2)</b>
$ git reset                                       <b class="conum">(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This commit will get blown away so a throw-away log message is OK.</p>
</li>
<li>
<p>This removes the <em>WIP</em> commit from the commit history, and sets
your working tree to the state just before you made that snapshot.</p>
</li>
<li>
<p>At this point the index file still has all the WIP changes you
committed as <em>snapshot WIP</em>.  This updates the index to show your
WIP files as uncommitted.</p>
<div class="paragraph">
<p>See also <a href='{{< relurl "docs/git-stash" >}}'>git-stash[1]</a>.</p>
</div>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Resetasinglefileintheindex"><a class="anchor" href="#Documentation/git-reset.txt-Resetasinglefileintheindex"></a>Reset a single file in the index </dt>
<dd>
<div class="paragraph">
<p>Suppose you have added a file to your index, but later decide you do not
want to add it to your commit. You can remove the file from the index
while keeping your changes with git reset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git reset -- frotz.c                      <b class="conum">(1)</b>
$ git commit -m "Commit files in index"     <b class="conum">(2)</b>
$ git add frotz.c                           <b class="conum">(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This removes the file from the index while keeping it in the working
directory.</p>
</li>
<li>
<p>This commits all other changes in the index.</p>
</li>
<li>
<p>Adds the file to the index again.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Keepchangesinworkingtreewhilediscardingsomepreviouscommits"><a class="anchor" href="#Documentation/git-reset.txt-Keepchangesinworkingtreewhilediscardingsomepreviouscommits"></a>Keep changes in working tree while discarding some previous commits </dt>
<dd>
<div class="paragraph">
<p>Suppose you are working on something and you commit it, and then you
continue working a bit more, but now you think that what you have in
your working tree should be in another branch that has nothing to do
with what you committed previously. You can start a new branch and
reset it while keeping the changes in your working tree.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git tag start
$ git switch -c branch1
$ edit
$ git commit ...                            <b class="conum">(1)</b>
$ edit
$ git switch -c branch2                     <b class="conum">(2)</b>
$ git reset --keep start                    <b class="conum">(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This commits your first edits in <span class='synopsis'><code>branch1</code></span>.</p>
</li>
<li>
<p>In the ideal world, you could have realized that the earlier
commit did not belong to the new topic when you created and switched
to <span class='synopsis'><code>branch2</code></span> (i.e. <span class='synopsis'><code>git</code> <code>switch</code> <code>-c</code> <code>branch2</code> <code>start</code></span>), but nobody is
perfect.</p>
</li>
<li>
<p>But you can use <span class='synopsis'><code>reset</code> <code>--keep</code></span> to remove the unwanted commit after
you switched to <span class='synopsis'><code>branch2</code></span>.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1" id="Documentation/git-reset.txt-Splitacommitapartintoasequenceofcommits"><a class="anchor" href="#Documentation/git-reset.txt-Splitacommitapartintoasequenceofcommits"></a>Split a commit apart into a sequence of commits </dt>
<dd>
<div class="paragraph">
<p>Suppose that you have created lots of logically separate changes and committed
them together. Then, later you decide that it might be better to have each
logical chunk associated with its own commit. You can use git reset to rewind
history without changing the contents of your local files, and then successively
use <span class='synopsis'><code>git</code> <code>add</code> <code>-p</code></span> to interactively select which hunks to include into each commit,
using <span class='synopsis'><code>git</code> <code>commit</code> <code>-c</code></span> to pre-populate the commit message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git reset -N HEAD^                        <b class="conum">(1)</b>
$ git add -p                                <b class="conum">(2)</b>
$ git diff --cached                         <b class="conum">(3)</b>
$ git commit -c HEAD@{1}                    <b class="conum">(4)</b>
...                                         <b class="conum">(5)</b>
$ git add ...                               <b class="conum">(6)</b>
$ git diff --cached                         <b class="conum">(7)</b>
$ git commit ...                            <b class="conum">(8)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First, reset the history back one commit so that we remove the original
commit, but leave the working tree with all the changes. The -N ensures
that any new files added with <span class='synopsis'><code>HEAD</code></span> are still marked so that <span class='synopsis'><code>git</code> <code>add</code> <code>-p</code></span>
will find them.</p>
</li>
<li>
<p>Next, we interactively select diff hunks to add using the <span class='synopsis'><code>git</code> <code>add</code> <code>-p</code></span>
facility. This will ask you about each diff hunk in sequence and you can
use simple commands such as "yes, include this", "No don&#8217;t include this"
or even the very powerful "edit" facility.</p>
</li>
<li>
<p>Once satisfied with the hunks you want to include, you should verify what
has been prepared for the first commit by using <span class='synopsis'><code>git</code> <code>diff</code> <code>--cached</code></span>. This
shows all the changes that have been moved into the index and are about
to be committed.</p>
</li>
<li>
<p>Next, commit the changes stored in the index. The <span class='synopsis'><code>-c</code></span> option specifies to
pre-populate the commit message from the original message that you started
with in the first commit. This is helpful to avoid retyping it. The
<span class='synopsis'><code>HEAD@{1}</code></span> is a special notation for the commit that <span class='synopsis'><code>HEAD</code></span> used to be at
prior to the original reset commit (1 change ago).
See <a href='{{< relurl "docs/git-reflog" >}}'>git-reflog[1]</a> for more details. You may also use any other
valid commit reference.</p>
</li>
<li>
<p>You can repeat steps 2-4 multiple times to break the original code into
any number of commits.</p>
</li>
<li>
<p>Now you&#8217;ve split out many of the changes into their own commits, and might
no longer use the patch mode of <span class='synopsis'><code>git</code> <code>add</code></span>, in order to select all remaining
uncommitted changes.</p>
</li>
<li>
<p>Once again, check to verify that you&#8217;ve included what you want to. You may
also wish to verify that git diff doesn&#8217;t show any remaining changes to be
committed later.</p>
</li>
<li>
<p>And finally create the final commit.</p>
</li>
</ol>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_discussion"><a class="anchor" href="#_discussion"></a>DISCUSSION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The tables below show what happens when running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git reset --option target</pre>
</div>
</div>
<div class="paragraph">
<p>to reset the <span class='synopsis'><code>HEAD</code></span> to another commit (<span class='synopsis'><code>target</code></span>) with the different
reset options depending on the state of the files.</p>
</div>
<div class="paragraph">
<p>In these tables, <span class='synopsis'><code>A</code></span>, <span class='synopsis'><code>B</code></span>, <span class='synopsis'><code>C</code></span> and <span class='synopsis'><code>D</code></span> are some different states of a
file. For example, the first line of the first table means that if a
file is in state <span class='synopsis'><code>A</code></span> in the working tree, in state <span class='synopsis'><code>B</code></span> in the index, in
state <span class='synopsis'><code>C</code></span> in <span class='synopsis'><code>HEAD</code></span> and in state <span class='synopsis'><code>D</code></span> in the target, then <span class='synopsis'><code>git</code> <code>reset</code> <code>--soft</code>

<code>target</code></span> will leave the file in the working tree in state <span class='synopsis'><code>A</code></span> and in the
index in state <span class='synopsis'><code>B</code></span>.  It resets (i.e. moves) the <span class='synopsis'><code>HEAD</code></span> (i.e. the tip of
the current branch, if you are on one) to <span class='synopsis'><code>target</code></span> (which has the file
in state <span class='synopsis'><code>D</code></span>).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 A       B     C    D     --soft   A       B     D
			  --mixed  A       D     D
			  --hard   D       D     D
			  --merge (disallowed)
			  --keep  (disallowed)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 A       B     C    C     --soft   A       B     C
			  --mixed  A       C     C
			  --hard   C       C     C
			  --merge (disallowed)
			  --keep   A       C     C</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 B       B     C    D     --soft   B       B     D
			  --mixed  B       D     D
			  --hard   D       D     D
			  --merge  D       D     D
			  --keep  (disallowed)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 B       B     C    C     --soft   B       B     C
			  --mixed  B       C     C
			  --hard   C       C     C
			  --merge  C       C     C
			  --keep   B       C     C</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 B       C     C    D     --soft   B       C     D
			  --mixed  B       D     D
			  --hard   D       D     D
			  --merge (disallowed)
			  --keep  (disallowed)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 B       C     C    C     --soft   B       C     C
			  --mixed  B       C     C
			  --hard   C       C     C
			  --merge  B       C     C
			  --keep   B       C     C</pre>
</div>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>reset</code> <code>--merge</code></span> is meant to be used when resetting out of a conflicted
merge. Any mergy operation guarantees that the working tree file that is
involved in the merge does not have a local change with respect to the index
before it starts, and that it writes the result out to the working tree. So if
we see some difference between the index and the target and also
between the index and the working tree, then it means that we are not
resetting out from a state that a mergy operation left after failing
with a conflict. That is why we disallow <span class='synopsis'><code>--merge</code></span> option in this case.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>reset</code> <code>--keep</code></span> is meant to be used when removing some of the last
commits in the current branch while keeping changes in the working
tree. If there could be conflicts between the changes in the commit we
want to remove and the changes in the working tree we want to keep,
the reset is disallowed. That&#8217;s why it is disallowed if there are both
changes between the working tree and <span class='synopsis'><code>HEAD</code></span>, and between <span class='synopsis'><code>HEAD</code></span> and the
target. To be safe, it is also disallowed when there are unmerged
entries.</p>
</div>
<div class="paragraph">
<p>The following tables show what happens when there are unmerged
entries:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 X       U     A    B     --soft  (disallowed)
			  --mixed  X       B     B
			  --hard   B       B     B
			  --merge  B       B     B
			  --keep  (disallowed)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>working index HEAD target         working index HEAD
----------------------------------------------------
 X       U     A    A     --soft  (disallowed)
			  --mixed  X       A     A
			  --hard   A       A     A
			  --merge  A       A     A
			  --keep  (disallowed)</pre>
</div>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>X</code></span> means any state and <span class='synopsis'><code>U</code></span> means an unmerged index.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_git"><a class="anchor" href="#_git"></a>GIT</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the <a href='{{< relurl "docs/git" >}}'>git[1]</a> suite</p>
</div>
</div>
</div>