---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - api-hashmap Documentation
docname: api-hashmap
version: 2.1.4
aliases:
- "/docs/api-hashmap/2.1.4/index.html"
- "/docs/api-hashmap/2.2.3/index.html"
- "/docs/api-hashmap/2.3.10/index.html"
- "/docs/api-hashmap/2.4.12/index.html"
- "/docs/api-hashmap/2.5.6/index.html"
- "/docs/api-hashmap/2.6.7/index.html"
- "/docs/api-hashmap/2.7.6/index.html"
- "/docs/api-hashmap/2.8.6/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The hashmap API is a generic implementation of hash-based key-value mappings.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_structures"><a class="anchor" href="#_data_structures"></a>Data Structures</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodestructcodecodehashmapcodespan"><a id="Documentation/technical/api-hashmap.txt-structhashmap" class="anchor" href="#Documentation/technical/api-hashmap.txt-structhashmap"></a><span class='synopsis'><code>struct</code> <code>hashmap</code></span> </dt>
<dd>
<p>The hash table structure. Members can be used as follows, but should
not be modified directly:</p>
<div class="paragraph">
<p>The <span class='synopsis'><code>size</code></span> member keeps track of the total number of entries (0 means the
hashmap is empty).</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>tablesize</code></span> is the allocated size of the hash table. A non-0 value indicates
that the hashmap is initialized. It may also be useful for statistical purposes
(i.e. <span class='synopsis'><code>size</code> <code>/</code> <code>tablesize</code></span> is the current load factor).</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>cmpfn</code></span> stores the comparison function specified in <span class='synopsis'><code>hashmap_init</code>()</span>. In
advanced scenarios, it may be useful to change this, e.g. to switch between
case-sensitive and case-insensitive lookup.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodestructcodecodehashmapentrycodespan"><a id="Documentation/technical/api-hashmap.txt-structhashmapentry" class="anchor" href="#Documentation/technical/api-hashmap.txt-structhashmapentry"></a><span class='synopsis'><code>struct</code> <code>hashmap_entry</code></span> </dt>
<dd>
<p>An opaque structure representing an entry in the hash table, which must
be used as first member of user data structures. Ideally it should be
followed by an int-sized member to prevent unused memory on 64-bit
systems due to alignment.</p>
<div class="paragraph">
<p>The <span class='synopsis'><code>hash</code></span> member is the entry&#8217;s hash code and the <span class='synopsis'><code>next</code></span> member points to the
next entry in case of collisions (i.e. if multiple entries map to the same
bucket).</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodestructcodecodehashmapitercodespan"><a id="Documentation/technical/api-hashmap.txt-structhashmapiter" class="anchor" href="#Documentation/technical/api-hashmap.txt-structhashmapiter"></a><span class='synopsis'><code>struct</code> <code>hashmap_iter</code></span> </dt>
<dd>
<p>An iterator structure, to be used with hashmap_iter_* functions.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_types"><a class="anchor" href="#_types"></a>Types</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeintcodecodehashmapcmpfncodecodeconstcodecodevoidcodecodeentrycodecodeconstcodecodevoidcodecodeentryorkeycodecodeconstcodecodevoidcodecodekeydatacodespan"><a id="Documentation/technical/api-hashmap.txt-inthashmapcmpfnconstvoidentryconstvoidentryorkeyconstvoidkeydata" class="anchor" href="#Documentation/technical/api-hashmap.txt-inthashmapcmpfnconstvoidentryconstvoidentryorkeyconstvoidkeydata"></a><span class='synopsis'><code>int</code> (<code>*hashmap_cmp_fn</code>)(<code>const</code> <code>void</code> <code>*entry,</code> <code>const</code> <code>void</code> <code>*entry_or_key,</code> <code>const</code> <code>void</code> <code>*keydata</code>)</span> </dt>
<dd>
<p>User-supplied function to test two hashmap entries for equality. Shall
return 0 if the entries are equal.</p>
<div class="paragraph">
<p>This function is always called with non-NULL <span class='synopsis'><code>entry</code></span> / <span class='synopsis'><code>entry_or_key</code></span>
parameters that have the same hash code. When looking up an entry, the <span class='synopsis'><code>key</code></span>
and <span class='synopsis'><code>keydata</code></span> parameters to hashmap_get and hashmap_remove are always passed
as second and third argument, respectively. Otherwise, <span class='synopsis'><code>keydata</code></span> is NULL.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functions"><a class="anchor" href="#_functions"></a>Functions</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeunsignedcodecodeintcodecodestrhashcodecodeconstcodecodecharcodecodebufcodespan"><a id="Documentation/technical/api-hashmap.txt-unsignedintstrhashconstcharbuf" class="anchor" href="#Documentation/technical/api-hashmap.txt-unsignedintstrhashconstcharbuf"></a><span class='synopsis'><code>unsigned</code> <code>int</code> <code>strhash</code>(<code>const</code> <code>char</code> <code>*buf</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeunsignedcodecodeintcodecodestrihashcodecodeconstcodecodecharcodecodebufcodespan"><a id="Documentation/technical/api-hashmap.txt-unsignedintstrihashconstcharbuf" class="anchor" href="#Documentation/technical/api-hashmap.txt-unsignedintstrihashconstcharbuf"></a><span class='synopsis'><code>unsigned</code> <code>int</code> <code>strihash</code>(<code>const</code> <code>char</code> <code>*buf</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeunsignedcodecodeintcodecodememhashcodecodeconstcodecodevoidcodecodebufcodecodesizetcodecodelencodespan"><a id="Documentation/technical/api-hashmap.txt-unsignedintmemhashconstvoidbufsizetlen" class="anchor" href="#Documentation/technical/api-hashmap.txt-unsignedintmemhashconstvoidbufsizetlen"></a><span class='synopsis'><code>unsigned</code> <code>int</code> <code>memhash</code>(<code>const</code> <code>void</code> <code>*buf,</code> <code>size_t</code> <code>len</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeunsignedcodecodeintcodecodememihashcodecodeconstcodecodevoidcodecodebufcodecodesizetcodecodelencodespan"><a id="Documentation/technical/api-hashmap.txt-unsignedintmemihashconstvoidbufsizetlen" class="anchor" href="#Documentation/technical/api-hashmap.txt-unsignedintmemihashconstvoidbufsizetlen"></a><span class='synopsis'><code>unsigned</code> <code>int</code> <code>memihash</code>(<code>const</code> <code>void</code> <code>*buf,</code> <code>size_t</code> <code>len</code>)</span> </dt>
<dd>
<p>Ready-to-use hash functions for strings, using the FNV-1 algorithm (see
<a href="http://www.isthe.com/chongo/tech/comp/fnv" class="bare">http://www.isthe.com/chongo/tech/comp/fnv</a>).</p>
<div class="paragraph">
<p><span class='synopsis'><code>strhash</code></span> and <span class='synopsis'><code>strihash</code></span> take 0-terminated strings, while <span class='synopsis'><code>memhash</code></span> and
<span class='synopsis'><code>memihash</code></span> operate on arbitrary-length memory.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>strihash</code></span> and <span class='synopsis'><code>memihash</code></span> are case insensitive versions.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeunsignedcodecodeintcodecodesha1hashcodecodeconstcodecodeunsignedcodecodecharcodecodesha1codespan"><a id="Documentation/technical/api-hashmap.txt-unsignedintsha1hashconstunsignedcharsha1" class="anchor" href="#Documentation/technical/api-hashmap.txt-unsignedintsha1hashconstunsignedcharsha1"></a><span class='synopsis'><code>unsigned</code> <code>int</code> <code>sha1hash</code>(<code>const</code> <code>unsigned</code> <code>char</code> <code>*sha1</code>)</span> </dt>
<dd>
<p>Converts a cryptographic hash (e.g. SHA-1) into an int-sized hash code
for use in hash tables. Cryptographic hashes are supposed to have
uniform distribution, so in contrast to <span class='synopsis'><code>memhash</code>()</span>, this just copies
the first <span class='synopsis'><code>sizeof</code>(<code>int</code>)</span> bytes without shuffling any bits. Note that
the results will be different on big-endian and little-endian
platforms, so they should not be stored or transferred over the net.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapinitcodecodestructcodecodehashmapcodecodemapcodecodehashmapcmpfncodecodeequalsfunctioncodecodesizetcodecodeinitialsizecodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapinitstructhashmapmaphashmapcmpfnequalsfunctionsizetinitialsize" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapinitstructhashmapmaphashmapcmpfnequalsfunctionsizetinitialsize"></a><span class='synopsis'><code>void</code> <code>hashmap_init</code>(<code>struct</code> <code>hashmap</code> <code>*map,</code> <code>hashmap_cmp_fn</code> <code>equals_function,</code> <code>size_t</code> <code>initial_size</code>)</span> </dt>
<dd>
<p>Initializes a hashmap structure.</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap to initialize.</p>
</div>
<div class="paragraph">
<p>The <span class='synopsis'><code>equals_function</code></span> can be specified to compare two entries for equality.
If NULL, entries are considered equal if their hash codes are equal.</p>
</div>
<div class="paragraph">
<p>If the total number of entries is known in advance, the <span class='synopsis'><code>initial_size</code></span>
parameter may be used to preallocate a sufficiently large table and thus
prevent expensive resizing. If 0, the table is dynamically resized.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapfreecodecodestructcodecodehashmapcodecodemapcodecodeintcodecodefreeentriescodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapfreestructhashmapmapintfreeentries" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapfreestructhashmapmapintfreeentries"></a><span class='synopsis'><code>void</code> <code>hashmap_free</code>(<code>struct</code> <code>hashmap</code> <code>*map,</code> <code>int</code> <code>free_entries</code>)</span> </dt>
<dd>
<p>Frees a hashmap structure and allocated memory.</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap to free.</p>
</div>
<div class="paragraph">
<p>If <span class='synopsis'><code>free_entries</code></span> is true, each hashmap_entry in the map is freed as well
(using stdlib&#8217;s free()).</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapentryinitcodecodevoidcodecodeentrycodecodeunsignedcodecodeintcodecodehashcodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapentryinitvoidentryunsignedinthash" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapentryinitvoidentryunsignedinthash"></a><span class='synopsis'><code>void</code> <code>hashmap_entry_init</code>(<code>void</code> <code>*entry,</code> <code>unsigned</code> <code>int</code> <code>hash</code>)</span> </dt>
<dd>
<p>Initializes a hashmap_entry structure.</p>
<div class="paragraph">
<p><span class='synopsis'><code>entry</code></span> points to the entry to initialize.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>hash</code></span> is the hash code of the entry.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapgetcodecodeconstcodecodestructcodecodehashmapcodecodemapcodecodeconstcodecodevoidcodecodekeycodecodeconstcodecodevoidcodecodekeydatacodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapgetconststructhashmapmapconstvoidkeyconstvoidkeydata" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapgetconststructhashmapmapconstvoidkeyconstvoidkeydata"></a><span class='synopsis'><code>void</code> <code>*hashmap_get</code>(<code>const</code> <code>struct</code> <code>hashmap</code> <code>*map,</code> <code>const</code> <code>void</code> <code>*key,</code> <code>const</code> <code>void</code> <code>*keydata</code>)</span> </dt>
<dd>
<p>Returns the hashmap entry for the specified key, or NULL if not found.</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap structure.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>key</code></span> is a hashmap_entry structure (or user data structure that starts with
hashmap_entry) that has at least been initialized with the proper hash code
(via <span class='synopsis'><code>hashmap_entry_init</code></span>).</p>
</div>
<div class="paragraph">
<p>If an entry with matching hash code is found, <span class='synopsis'><code>key</code></span> and <span class='synopsis'><code>keydata</code></span> are passed
to <span class='synopsis'><code>hashmap_cmp_fn</code></span> to decide whether the entry matches the key.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapgetfromhashcodecodeconstcodecodestructcodecodehashmapcodecodemapcodecodeunsignedcodecodeintcodecodehashcodecodeconstcodecodevoidcodecodekeydatacodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapgetfromhashconststructhashmapmapunsignedinthashconstvoidkeydata" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapgetfromhashconststructhashmapmapunsignedinthashconstvoidkeydata"></a><span class='synopsis'><code>void</code> <code>*hashmap_get_from_hash</code>(<code>const</code> <code>struct</code> <code>hashmap</code> <code>*map,</code> <code>unsigned</code> <code>int</code> <code>hash,</code> <code>const</code> <code>void</code> <code>*keydata</code>)</span> </dt>
<dd>
<p>Returns the hashmap entry for the specified hash code and key data,
or NULL if not found.</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap structure.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>hash</code></span> is the hash code of the entry to look up.</p>
</div>
<div class="paragraph">
<p>If an entry with matching hash code is found, <span class='synopsis'><code>keydata</code></span> is passed to
<span class='synopsis'><code>hashmap_cmp_fn</code></span> to decide whether the entry matches the key. The
<span class='synopsis'><code>entry_or_key</code></span> parameter points to a bogus hashmap_entry structure that
should not be used in the comparison.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapgetnextcodecodeconstcodecodestructcodecodehashmapcodecodemapcodecodeconstcodecodevoidcodecodeentrycodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapgetnextconststructhashmapmapconstvoidentry" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapgetnextconststructhashmapmapconstvoidentry"></a><span class='synopsis'><code>void</code> <code>*hashmap_get_next</code>(<code>const</code> <code>struct</code> <code>hashmap</code> <code>*map,</code> <code>const</code> <code>void</code> <code>*entry</code>)</span> </dt>
<dd>
<p>Returns the next equal hashmap entry, or NULL if not found. This can be
used to iterate over duplicate entries (see <span class='synopsis'><code>hashmap_add</code></span>).</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap structure.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>entry</code></span> is the hashmap_entry to start the search from, obtained via a previous
call to <span class='synopsis'><code>hashmap_get</code></span> or <span class='synopsis'><code>hashmap_get_next</code></span>.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapaddcodecodestructcodecodehashmapcodecodemapcodecodevoidcodecodeentrycodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapaddstructhashmapmapvoidentry" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapaddstructhashmapmapvoidentry"></a><span class='synopsis'><code>void</code> <code>hashmap_add</code>(<code>struct</code> <code>hashmap</code> <code>*map,</code> <code>void</code> <code>*entry</code>)</span> </dt>
<dd>
<p>Adds a hashmap entry. This allows to add duplicate entries (i.e.
separate values with the same key according to hashmap_cmp_fn).</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap structure.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>entry</code></span> is the entry to add.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapputcodecodestructcodecodehashmapcodecodemapcodecodevoidcodecodeentrycodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapputstructhashmapmapvoidentry" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapputstructhashmapmapvoidentry"></a><span class='synopsis'><code>void</code> <code>*hashmap_put</code>(<code>struct</code> <code>hashmap</code> <code>*map,</code> <code>void</code> <code>*entry</code>)</span> </dt>
<dd>
<p>Adds or replaces a hashmap entry. If the hashmap contains duplicate
entries equal to the specified entry, only one of them will be replaced.</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap structure.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>entry</code></span> is the entry to add or replace.</p>
</div>
<div class="paragraph">
<p>Returns the replaced entry, or NULL if not found (i.e. the entry was added).</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapremovecodecodestructcodecodehashmapcodecodemapcodecodeconstcodecodevoidcodecodekeycodecodeconstcodecodevoidcodecodekeydatacodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapremovestructhashmapmapconstvoidkeyconstvoidkeydata" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapremovestructhashmapmapconstvoidkeyconstvoidkeydata"></a><span class='synopsis'><code>void</code> <code>*hashmap_remove</code>(<code>struct</code> <code>hashmap</code> <code>*map,</code> <code>const</code> <code>void</code> <code>*key,</code> <code>const</code> <code>void</code> <code>*keydata</code>)</span> </dt>
<dd>
<p>Removes a hashmap entry matching the specified key. If the hashmap
contains duplicate entries equal to the specified key, only one of
them will be removed.</p>
<div class="paragraph">
<p><span class='synopsis'><code>map</code></span> is the hashmap structure.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>key</code></span> is a hashmap_entry structure (or user data structure that starts with
hashmap_entry) that has at least been initialized with the proper hash code
(via <span class='synopsis'><code>hashmap_entry_init</code></span>).</p>
</div>
<div class="paragraph">
<p>If an entry with matching hash code is found, <span class='synopsis'><code>key</code></span> and <span class='synopsis'><code>keydata</code></span> are
passed to <span class='synopsis'><code>hashmap_cmp_fn</code></span> to decide whether the entry matches the key.</p>
</div>
<div class="paragraph">
<p>Returns the removed entry, or NULL if not found.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapiterinitcodecodestructcodecodehashmapcodecodemapcodecodestructcodecodehashmapitercodecodeitercodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapiterinitstructhashmapmapstructhashmapiteriter" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapiterinitstructhashmapmapstructhashmapiteriter"></a><span class='synopsis'><code>void</code> <code>hashmap_iter_init</code>(<code>struct</code> <code>hashmap</code> <code>*map,</code> <code>struct</code> <code>hashmap_iter</code> <code>*iter</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapiternextcodecodestructcodecodehashmapitercodecodeitercodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapiternextstructhashmapiteriter" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapiternextstructhashmapiteriter"></a><span class='synopsis'><code>void</code> <code>*hashmap_iter_next</code>(<code>struct</code> <code>hashmap_iter</code> <code>*iter</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodevoidcodecodehashmapiterfirstcodecodestructcodecodehashmapcodecodemapcodecodestructcodecodehashmapitercodecodeitercodespan"><a id="Documentation/technical/api-hashmap.txt-voidhashmapiterfirststructhashmapmapstructhashmapiteriter" class="anchor" href="#Documentation/technical/api-hashmap.txt-voidhashmapiterfirststructhashmapmapstructhashmapiteriter"></a><span class='synopsis'><code>void</code> <code>*hashmap_iter_first</code>(<code>struct</code> <code>hashmap</code> <code>*map,</code> <code>struct</code> <code>hashmap_iter</code> <code>*iter</code>)</span> </dt>
<dd>
<p>Used to iterate over all entries of a hashmap.</p>
<div class="paragraph">
<p><span class='synopsis'><code>hashmap_iter_init</code></span> initializes a <span class='synopsis'><code>hashmap_iter</code></span> structure.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>hashmap_iter_next</code></span> returns the next hashmap_entry, or NULL if there are no
more entries.</p>
</div>
<div class="paragraph">
<p><span class='synopsis'><code>hashmap_iter_first</code></span> is a combination of both (i.e. initializes the iterator
and returns the first entry, if any).</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeconstcodecodecharcodecodestrinterncodecodeconstcodecodecharcodecodestringcodespan"><a id="Documentation/technical/api-hashmap.txt-constcharstrinternconstcharstring" class="anchor" href="#Documentation/technical/api-hashmap.txt-constcharstrinternconstcharstring"></a><span class='synopsis'><code>const</code> <code>char</code> <code>*strintern</code>(<code>const</code> <code>char</code> <code>*string</code>)</span> </dt>
<dt class="hdlist1" id="Documentation/technical/api-hashmap.txt-spanclasssynopsiscodeconstcodecodevoidcodecodememinterncodecodeconstcodecodevoidcodecodedatacodecodesizetcodecodelencodespan"><a id="Documentation/technical/api-hashmap.txt-constvoidmeminternconstvoiddatasizetlen" class="anchor" href="#Documentation/technical/api-hashmap.txt-constvoidmeminternconstvoiddatasizetlen"></a><span class='synopsis'><code>const</code> <code>void</code> <code>*memintern</code>(<code>const</code> <code>void</code> <code>*data,</code> <code>size_t</code> <code>len</code>)</span> </dt>
<dd>
<p>Returns the unique, interned version of the specified string or data,
similar to the <span class='synopsis'><code>String.intern</code></span> API in Java and .NET, respectively.
Interned strings remain valid for the entire lifetime of the process.</p>
<div class="paragraph">
<p>Can be used as <span class='synopsis'>[<code>x</code>]<code>strdup</code>()</span> or <span class='synopsis'><code>xmemdupz</code></span> replacement, except that interned
strings / data must not be modified or freed.</p>
</div>
<div class="paragraph">
<p>Interned strings are best used for short strings with high probability of
duplicates.</p>
</div>
<div class="paragraph">
<p>Uses a hashmap to store the pool of interned strings.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage_example"><a class="anchor" href="#_usage_example"></a>Usage example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here&#8217;s a simple usage example that maps long keys to double values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>struct hashmap map;

struct long2double {
	struct hashmap_entry ent; /* must be the first member! */
	long key;
	double value;
};

static int long2double_cmp(const struct long2double *e1, const struct long2double *e2, const void *unused)
{
	return !(e1-&gt;key == e2-&gt;key);
}

void long2double_init(void)
{
	hashmap_init(&amp;map, (hashmap_cmp_fn) long2double_cmp, 0);
}

void long2double_free(void)
{
	hashmap_free(&amp;map, 1);
}

static struct long2double *find_entry(long key)
{
	struct long2double k;
	hashmap_entry_init(&amp;k, memhash(&amp;key, sizeof(long)));
	k.key = key;
	return hashmap_get(&amp;map, &amp;k, NULL);
}

double get_value(long key)
{
	struct long2double *e = find_entry(key);
	return e ? e-&gt;value : 0;
}

void set_value(long key, double value)
{
	struct long2double *e = find_entry(key);
	if (!e) {
		e = malloc(sizeof(struct long2double));
		hashmap_entry_init(e, memhash(&amp;key, sizeof(long)));
		e-&gt;key = key;
		hashmap_add(&amp;map, e);
	}
	e-&gt;value = value;
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_variable_sized_keys"><a class="anchor" href="#_using_variable_sized_keys"></a>Using variable-sized keys</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <span class='synopsis'><code>hashmap_entry_get</code></span> and <span class='synopsis'><code>hashmap_entry_remove</code></span> functions expect an ordinary
<span class='synopsis'><code>hashmap_entry</code></span> structure as key to find the correct entry. If the key data is
variable-sized (e.g. a FLEX_ARRAY string) or quite large, it is undesirable
to create a full-fledged entry structure on the heap and copy all the key data
into the structure.</p>
</div>
<div class="paragraph">
<p>In this case, the <span class='synopsis'><code>keydata</code></span> parameter can be used to pass
variable-sized key data directly to the comparison function, and the <span class='synopsis'><code>key</code></span>
parameter can be a stripped-down, fixed size entry structure allocated on the
stack.</p>
</div>
<div class="paragraph">
<p>See test-hashmap.c for an example using arbitrary-length strings as keys.</p>
</div>
</div>
</div>